<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Cambridge SMT System: lmbr.gtest.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cambridge SMT System
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lmbr_8gtest_8cpp_source.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">lmbr.gtest.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="lmbr_8gtest_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// you may not use these files except in compliance with the License.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// You may obtain a copy of the License at</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//    http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// limitations under the License.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// Copyright 2012 - Gonzalo Iglesias, Adri√† de Gispert, William Byrne</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="openfst_8h.html">openfst.h</a>&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="googletesting_8h.html">googletesting.h</a>&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#ifndef GMAINTEST</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="main_8custom__assert_8hpp.html">main.custom_assert.hpp</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="main_8logger_8hpp.html">main.logger.hpp</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lexicographic-tropical-tropical-incls_8h.html">lexicographic-tropical-tropical-incls.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lexicographic-tropical-tropical-funcs_8h.html">lexicographic-tropical-tropical-funcs.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="range_8hpp.html">range.hpp</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fstio_8hpp.html">fstio.hpp</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fstutils_8hpp.html">fstutils.hpp</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fstutils_8mapper_8hpp.html">fstutils.mapper.hpp</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fstutils_8ftcompose_8hpp.html">fstutils.ftcompose.hpp</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fstutils_8extractngrams_8hpp.html">fstutils.extractngrams.hpp</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="taskinterface_8hpp.html">taskinterface.hpp</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="data_8lmbr_8hpp.html">data.lmbr.hpp</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="task_8lmbr_8hpp.html">task.lmbr.hpp</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keyword">namespace </span>bfs = boost::filesystem;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceucam_1_1lmbr.html">ul</a> = <a class="code" href="namespaceucam_1_1lmbr.html">ucam::lmbr</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//Test the ngram extraction wrapper -- the test is pretty much the same as basic ngram extraction</span></div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="lmbr_8gtest_8cpp.html#a14b30d3aafdbb934f1c83822063b8141">   49</a></span>&#160;<a class="code" href="lmbr_8gtest_8cpp.html#a14b30d3aafdbb934f1c83822063b8141">TEST</a> (lmbr, extractngrams) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  fst::VectorFst&lt;fst::StdArc&gt; a, b;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  a.AddState();</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  a.SetStart ( 0 );</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  a.AddState();</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  a.AddArc ( 0, fst::StdArc ( 1, 1, 0, 1 ) );</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  a.AddState();</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  a.AddArc ( 1, fst::StdArc ( 2, 2, 0, 2 ) );</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  a.AddState();</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  a.AddArc ( 2, fst::StdArc ( 3, 3, 0, 3 ) );</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  a.AddArc ( 1, fst::StdArc ( 5, 5, 0, 3 ) );</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  a.AddState();</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  a.AddArc ( 3, fst::StdArc ( 4, 4, 0, 4 ) );</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  a.SetFinal ( 4, fst::StdArc::Weight::One() );</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  a.AddState();</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  a.AddArc ( 2, fst::StdArc ( 6, 6, 0, 5 ) );</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  a.AddArc ( 5, fst::StdArc ( 7, 7, 0, 4 ) );</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  std::vector&lt;fst::NGramList&gt; ng;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  ul::extractNGrams&lt;fst::StdArc&gt; (a, ng);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  std::stringstream ss;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; ng.size(); ++k)</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">for</span> (fst::NGramList::iterator itx = ng[k].begin(); itx != ng[k].end(); ++itx) {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      ss &lt;&lt; itx-&gt;first &lt;&lt; endl;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      EXPECT_TRUE (itx-&gt;second == fst::StdArc::Weight::One() );</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// 2 refs due to sorting</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  std::string ngrams =  <span class="stringliteral">&quot;1\n2\n3\n4\n5\n6\n7\n6 7\n2 3\n1 5\n2 6\n1 2\n3 4\n5 4\n1 2 6\n1 5 4\n2 6 7\n2 3 4\n1 2 3\n1 2 3 4\n1 2 6 7\n&quot;</span>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  std::string ngrams2 = <span class="stringliteral">&quot;7\n6\n5\n4\n3\n2\n1\n5 4\n3 4\n6 7\n2 3\n1 5\n2 6\n1 2\n2 6 7\n2 3 4\n1 5 4\n1 2 6\n1 2 3\n1 2 6 7\n1 2 3 4\n&quot;</span>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="logger_8boost__log_8hpp.html#a136d9d772791ddd40a7781b0f6b01dd6">LDEBUG</a>(<span class="stringliteral">&quot;ss=&quot;</span> &lt;&lt; ss.str());</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  EXPECT_TRUE (ngrams == ss.str() || ngrams2 == ss.str() );</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">unsigned</span> size = ul::extractNGrams&lt;fst::StdArc&gt; (b, ng);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  EXPECT_TRUE (size == 0);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="lmbr_8gtest_8cpp.html#a00a2224d6982001100e8fa801d21b17a">   84</a></span>&#160;<a class="code" href="lmbr_8gtest_8cpp.html#a14b30d3aafdbb934f1c83822063b8141">TEST</a> (lmbr, theta) {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="classucam_1_1lmbr_1_1Theta.html">ul::Theta</a> theta;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  EXPECT_EQ (theta (0), 0.0f);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 1; k &lt;= 4; ++k)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    EXPECT_EQ (theta (k), 1);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;}</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="lmbr_8gtest_8cpp.html#a62217ca26b9b0aa0b2931ece55c31756">   91</a></span>&#160;<a class="code" href="lmbr_8gtest_8cpp.html#a14b30d3aafdbb934f1c83822063b8141">TEST</a> (lmbr, computeapplyposteriors) {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">//Apply posteriors to a trivial hypotheses space and test scores.</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">//Read evidence space = hypotheses space!</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  fst::VectorFst&lt;fst::StdArc&gt; myfst;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  myfst.AddState();</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  myfst.SetStart (0);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  myfst.AddState();</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  myfst.AddArc (0, fst::StdArc (1, 1, 37.6542969, 1) );</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  myfst.AddState();</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  myfst.AddArc (1, fst::StdArc (933, 933, 0, 2) );</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  myfst.AddState();</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  myfst.AddArc (2, fst::StdArc (18, 18, 4.73828125, 3) );</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  myfst.AddState();</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  myfst.AddArc (2, fst::StdArc (150, 150, 0, 4) );</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  myfst.AddState();</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  myfst.AddArc (2, fst::StdArc (226, 226, 5.52148438, 5) );</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  myfst.AddArc (2, fst::StdArc (508, 508, 8.22265625, 5) );</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  myfst.AddArc (3, fst::StdArc (24, 24, 0, 5) );</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  myfst.AddState();</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  myfst.AddArc (5, fst::StdArc (150, 150, 0, 6) );</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  myfst.AddState();</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  myfst.AddArc (4, fst::StdArc (2, 2, 0, 7) );</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  myfst.AddArc (4, fst::StdArc (23, 23, 5.90625, 7) );</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  myfst.AddArc (6, fst::StdArc (2, 2, 0, 7) );</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  myfst.SetFinal (7, fst::StdArc::Weight::One() );</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  std::vector&lt;fst::NGramList&gt; ng;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">//Extract ngrams</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  ul::extractNGrams&lt;fst::StdArc&gt; (myfst, ng);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">//Compute posteriors</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="classucam_1_1lmbr_1_1ComputePosteriors.html">ul::ComputePosteriors</a> cp (ng);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  cp (&amp;myfst);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    std::stringstream ss;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classucam_1_1util_1_1oszfstream.html">uu::oszfstream</a> j (ss);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    cp.WritePosteriors (j);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    std::string expectedposteriors =</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="stringliteral">&quot;0.002680170144\t23 \n0.999996857723\t1 \n0.000264338191\t508 \n0.008617965440\t24 \n0.997316613516\t2 \n0.003937893375\t226 \n0.999996857723\t150 \n0.008617965440\t18 \n0.999996857723\t933 \n0.003937893375\t226 150 \n0.997316613516\t150 2 \n0.008617965440\t18 24 \n0.003937893375\t933 226 \n0.000264338191\t933 508 \n0.987176612683\t933 150 \n0.008617965440\t933 18 \n0.999996857723\t1 933 \n0.000264338191\t508 150 \n0.008617965440\t24 150 \n0.002680170144\t150 23 \n0.000264338191\t933 508 150 \n0.008617965440\t18 24 150 \n0.984496437005\t933 150 2 \n0.003937893375\t226 150 2 \n0.987176612683\t1 933 150 \n0.003937893375\t1 933 226 \n0.000264338191\t1 933 508 \n0.003937893375\t933 226 150 \n0.008617965440\t24 150 2 \n0.000264338191\t508 150 2 \n0.008617965440\t933 18 24 \n0.002680170144\t933 150 23 \n0.008617965440\t1 933 18 \n0.008617965440\t1 933 18 24 \n0.008617965440\t933 18 24 150 \n0.003937893375\t1 933 226 150 \n0.008617965440\t18 24 150 2 \n0.002680170144\t1 933 150 23 \n0.003937893375\t933 226 150 2 \n0.000264338191\t1 933 508 150 \n0.000264338191\t933 508 150 2 \n0.984496437005\t1 933 150 2 \n&quot;</span>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// sorting differences:</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    std::string expectedposteriors2 =</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="stringliteral">&quot;0.999996857723\t933 \n0.003937893375\t226 \n0.999996857723\t150 \n0.008617965440\t18 \n0.000264338191\t508 \n0.008617965440\t24 \n0.997316613516\t2 \n0.002680170144\t23 \n0.999996857723\t1 \n0.000264338191\t933 508 \n0.999996857723\t1 933 \n0.997316613516\t150 2 \n0.003937893375\t226 150 \n0.008617965440\t24 150 \n0.000264338191\t508 150 \n0.002680170144\t150 23 \n0.008617965440\t933 18 \n0.008617965440\t18 24 \n0.987176612683\t933 150 \n0.003937893375\t933 226 \n0.000264338191\t933 508 150 \n0.003937893375\t933 226 150 \n0.002680170144\t933 150 23 \n0.008617965440\t1 933 18 \n0.000264338191\t1 933 508 \n0.987176612683\t1 933 150 \n0.003937893375\t1 933 226 \n0.984496437005\t933 150 2 \n0.008617965440\t18 24 150 \n0.008617965440\t24 150 2 \n0.008617965440\t933 18 24 \n0.000264338191\t508 150 2 \n0.003937893375\t226 150 2 \n0.000264338191\t933 508 150 2 \n0.003937893375\t933 226 150 2 \n0.000264338191\t1 933 508 150 \n0.008617965440\t933 18 24 150 \n0.003937893375\t1 933 226 150 \n0.008617965440\t18 24 150 2 \n0.002680170144\t1 933 150 23 \n0.984496437005\t1 933 150 2 \n0.008617965440\t1 933 18 24 \n&quot;</span>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    EXPECT_TRUE (static_cast&lt;std::stringstream *&gt; (j.<a class="code" href="classucam_1_1util_1_1oszfstream.html#af7c1f80380b9c75d34d07805bbbe0f55">getStream</a>() )-&gt;str() == expectedposteriors</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                 || <span class="keyword">static_cast&lt;</span>std::stringstream *<span class="keyword">&gt;</span> (j.<a class="code" href="classucam_1_1util_1_1oszfstream.html#af7c1f80380b9c75d34d07805bbbe0f55">getStream</a>() )-&gt;str() == expectedposteriors2</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                 );</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="classucam_1_1lmbr_1_1Theta.html">ul::Theta</a> theta;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="namespaceucam_1_1lmbr.html#a61c19effa8667d018e8c478895dd48f6">ul::NGramToPosteriorsMapper</a>&amp; pst = cp.getPosteriors();</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="classucam_1_1lmbr_1_1ApplyPosteriors.html">ul::ApplyPosteriors</a> ap (ng, pst, theta);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="function-weight_8h.html#a9f0f70f9947eb73fa75a0171aa3a11dc">fst::Map</a> (&amp;myfst, fst::RmWeightMapper&lt;fst::StdArc&gt;() );</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  fst::VectorFst&lt;fst::StdArc&gt; *output = ap (myfst);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  myfst = *output;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">//Just check 1-best</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  fst::ShortestPath (myfst, output);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  fst::TopSort (output);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">//  output-&gt;Write(&quot;output-final.fst&quot;);</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    std::stringstream ss;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="namespacefst.html#a63eb5e1f918b40e4888560d506dc453a">fst::printstrings</a> (*output, &amp;ss);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    EXPECT_EQ (ss.str(), <span class="stringliteral">&quot;1 933 150 2 || 1 933 150 2 || -9.93797\n&quot;</span>);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keyword">delete</span> output;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#ifndef GMAINTEST</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="lmbr_8gtest_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">  157</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="lmbr_8gtest_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> ( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv ) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  ::testing::InitGoogleTest ( &amp;argc, argv );</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordflow">return</span> RUN_ALL_TESTS();</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;}</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="classucam_1_1util_1_1oszfstream_html"><div class="ttname"><a href="classucam_1_1util_1_1oszfstream.html">ucam::util::oszfstream</a></div><div class="ttdoc">Wrapper stream class that writes to pipes, text files or gzipped files. </div><div class="ttdef"><b>Definition:</b> <a href="szfstream_8hpp_source.html#l00200">szfstream.hpp:200</a></div></div>
<div class="ttc" id="openfst_8h_html"><div class="ttname"><a href="openfst_8h.html">openfst.h</a></div><div class="ttdoc">Unit testing: google testing common header. </div></div>
<div class="ttc" id="classucam_1_1util_1_1oszfstream_html_af7c1f80380b9c75d34d07805bbbe0f55"><div class="ttname"><a href="classucam_1_1util_1_1oszfstream.html#af7c1f80380b9c75d34d07805bbbe0f55">ucam::util::oszfstream::getStream</a></div><div class="ttdeci">std::ostream * getStream()</div><div class="ttdoc">Returns internal stream. </div><div class="ttdef"><b>Definition:</b> <a href="szfstream_8hpp_source.html#l00241">szfstream.hpp:241</a></div></div>
<div class="ttc" id="lexicographic-tropical-tropical-funcs_8h_html"><div class="ttname"><a href="lexicographic-tropical-tropical-funcs_8h.html">lexicographic-tropical-tropical-funcs.h</a></div><div class="ttdoc">Convenience functors/functions for lexicographic&lt;tropical,tropical&gt; semiring. </div></div>
<div class="ttc" id="fstio_8hpp_html"><div class="ttname"><a href="fstio_8hpp.html">fstio.hpp</a></div><div class="ttdoc">Contains convenience functions to write and read fsts. </div></div>
<div class="ttc" id="fstutils_8ftcompose_8hpp_html"><div class="ttname"><a href="fstutils_8ftcompose_8hpp.html">fstutils.ftcompose.hpp</a></div><div class="ttdoc">Implementation of different type of compositions (i.e. failure transitions) </div></div>
<div class="ttc" id="function-weight_8h_html_a9f0f70f9947eb73fa75a0171aa3a11dc"><div class="ttname"><a href="function-weight_8h.html#a9f0f70f9947eb73fa75a0171aa3a11dc">Map</a></div><div class="ttdeci">fst::TropicalWeightTpl&lt; F &gt; Map(double)</div></div>
<div class="ttc" id="logger_8boost__log_8hpp_html_a136d9d772791ddd40a7781b0f6b01dd6"><div class="ttname"><a href="logger_8boost__log_8hpp.html#a136d9d772791ddd40a7781b0f6b01dd6">LDEBUG</a></div><div class="ttdeci">#define LDEBUG(msg)</div><div class="ttdef"><b>Definition:</b> <a href="logger_8boost__log_8hpp_source.html#l00107">logger.boost_log.hpp:107</a></div></div>
<div class="ttc" id="namespaceucam_1_1lmbr_html_a61c19effa8667d018e8c478895dd48f6"><div class="ttname"><a href="namespaceucam_1_1lmbr.html#a61c19effa8667d018e8c478895dd48f6">ucam::lmbr::NGramToPosteriorsMapper</a></div><div class="ttdeci">unordered_map&lt; fst::NGram, std::vector&lt; std::vector&lt; Posterior &gt; &gt;, ucam::util::hashfvecuint, ucam::util::hasheqvecuint &gt; NGramToPosteriorsMapper</div><div class="ttdef"><b>Definition:</b> <a href="data_8lmbr_8hpp_source.html#l00035">data.lmbr.hpp:35</a></div></div>
<div class="ttc" id="taskinterface_8hpp_html"><div class="ttname"><a href="taskinterface_8hpp.html">taskinterface.hpp</a></div><div class="ttdoc">Interfaces with basic methods for iteration. </div></div>
<div class="ttc" id="classucam_1_1lmbr_1_1Theta_html"><div class="ttname"><a href="classucam_1_1lmbr_1_1Theta.html">ucam::lmbr::Theta</a></div><div class="ttdoc">Functor handling LMBR theta parameters. </div><div class="ttdef"><b>Definition:</b> <a href="task_8lmbr_8applyposteriors_8hpp_source.html#l00029">task.lmbr.applyposteriors.hpp:29</a></div></div>
<div class="ttc" id="namespacefst_html_a63eb5e1f918b40e4888560d506dc453a"><div class="ttname"><a href="namespacefst.html#a63eb5e1f918b40e4888560d506dc453a">fst::printstrings</a></div><div class="ttdeci">void printstrings(const fst::VectorFst&lt; Arc &gt; &amp;pcostslat, std::ostream *hyps, unsigned s=0)</div><div class="ttdoc">Trivial function that outputs all the hypothesis in the lattice with its cost. </div><div class="ttdef"><b>Definition:</b> <a href="fstutils_8hpp_source.html#l00253">fstutils.hpp:253</a></div></div>
<div class="ttc" id="classucam_1_1lmbr_1_1ComputePosteriors_html"><div class="ttname"><a href="classucam_1_1lmbr_1_1ComputePosteriors.html">ucam::lmbr::ComputePosteriors</a></div><div class="ttdef"><b>Definition:</b> <a href="task_8lmbr_8computeposteriors_8hpp_source.html#l00029">task.lmbr.computeposteriors.hpp:29</a></div></div>
<div class="ttc" id="main_8logger_8hpp_html"><div class="ttname"><a href="main_8logger_8hpp.html">main.logger.hpp</a></div><div class="ttdoc">Static variables for logger. Include only once from main file. </div></div>
<div class="ttc" id="fstutils_8hpp_html"><div class="ttname"><a href="fstutils_8hpp.html">fstutils.hpp</a></div><div class="ttdoc">Utilites to extract vocabulary, pseudo-determinize lattices and build substring transducers. </div></div>
<div class="ttc" id="lexicographic-tropical-tropical-incls_8h_html"><div class="ttname"><a href="lexicographic-tropical-tropical-incls_8h.html">lexicographic-tropical-tropical-incls.h</a></div><div class="ttdoc">Headers for standalone shared library. </div></div>
<div class="ttc" id="task_8lmbr_8hpp_html"><div class="ttname"><a href="task_8lmbr_8hpp.html">task.lmbr.hpp</a></div><div class="ttdoc">Lattice MBR task ‚Äì integrates lattice mbr as a task that can be used standalone (implemented) or inc...</div></div>
<div class="ttc" id="fstutils_8mapper_8hpp_html"><div class="ttname"><a href="fstutils_8mapper_8hpp.html">fstutils.mapper.hpp</a></div><div class="ttdoc">Generalized weight mapper functor. </div></div>
<div class="ttc" id="lmbr_8gtest_8cpp_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="lmbr_8gtest_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="lmbr_8gtest_8cpp_source.html#l00157">lmbr.gtest.cpp:157</a></div></div>
<div class="ttc" id="data_8lmbr_8hpp_html"><div class="ttname"><a href="data_8lmbr_8hpp.html">data.lmbr.hpp</a></div></div>
<div class="ttc" id="classucam_1_1lmbr_1_1ApplyPosteriors_html"><div class="ttname"><a href="classucam_1_1lmbr_1_1ApplyPosteriors.html">ucam::lmbr::ApplyPosteriors</a></div><div class="ttdoc">Functor that applies posteriors to any hypothesis space. Initializes with previously calculated poste...</div><div class="ttdef"><b>Definition:</b> <a href="task_8lmbr_8applyposteriors_8hpp_source.html#l00080">task.lmbr.applyposteriors.hpp:80</a></div></div>
<div class="ttc" id="range_8hpp_html"><div class="ttname"><a href="range_8hpp.html">range.hpp</a></div><div class="ttdoc">Handles different type of integer ranges. </div></div>
<div class="ttc" id="lmbr_8gtest_8cpp_html_a14b30d3aafdbb934f1c83822063b8141"><div class="ttname"><a href="lmbr_8gtest_8cpp.html#a14b30d3aafdbb934f1c83822063b8141">TEST</a></div><div class="ttdeci">TEST(lmbr, extractngrams)</div><div class="ttdef"><b>Definition:</b> <a href="lmbr_8gtest_8cpp_source.html#l00049">lmbr.gtest.cpp:49</a></div></div>
<div class="ttc" id="namespaceucam_1_1lmbr_html"><div class="ttname"><a href="namespaceucam_1_1lmbr.html">ucam::lmbr</a></div><div class="ttdef"><b>Definition:</b> <a href="data-main_8lmbr_8hpp_source.html#l00019">data-main.lmbr.hpp:19</a></div></div>
<div class="ttc" id="fstutils_8extractngrams_8hpp_html"><div class="ttname"><a href="fstutils_8extractngrams_8hpp.html">fstutils.extractngrams.hpp</a></div></div>
<div class="ttc" id="googletesting_8h_html"><div class="ttname"><a href="googletesting_8h.html">googletesting.h</a></div><div class="ttdoc">Unit testing: google testing common header. </div></div>
<div class="ttc" id="main_8custom__assert_8hpp_html"><div class="ttname"><a href="main_8custom__assert_8hpp.html">main.custom_assert.hpp</a></div><div class="ttdoc">Static variable for custom_assert. Include only once from main file. </div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_701c0c8b41b031e69113781f2f4e5321.html">ucam-smt</a></li><li class="navelem"><a class="el" href="dir_6c232e806e8d6cc2bbc4c32b14734fc5.html">cpp</a></li><li class="navelem"><a class="el" href="dir_9d41211f7c8127beed73b967f6bcda10.html">tests</a></li><li class="navelem"><a class="el" href="lmbr_8gtest_8cpp.html">lmbr.gtest.cpp</a></li>
    <li class="footer">Generated on Wed May 25 2016 10:13:36 for Cambridge SMT System by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
