<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Cambridge SMT System: hifst.task.hifst.gtest.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Cambridge SMT System
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('hifst_8task_8hifst_8gtest_8cpp_source.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">hifst.task.hifst.gtest.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="hifst_8task_8hifst_8gtest_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// you may not use these files except in compliance with the License.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// You may obtain a copy of the License at</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//    http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// See the License for the specific language governing permissions and</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// limitations under the License.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// Copyright 2012 - Gonzalo Iglesias, Adri√† de Gispert, William Byrne</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="openfst_8h.html" title="Unit testing: google testing common header. ">openfst.h</a>&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="googletesting_8h.html" title="Unit testing: google testing common header. ">googletesting.h</a>&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#ifndef GMAINTEST</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="main_8custom__assert_8hpp.html" title="Static variable for custom_assert. Include only once from main file. ">main.custom_assert.hpp</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="main_8logger_8hpp.html" title="Static variables for logger. Include only once from main file. ">main.logger.hpp</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="params_8hpp.html" title="Convenience functions to parse parameters from a string. ">params.hpp</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="wordmapper_8hpp.html" title="class WordMapper ">wordmapper.hpp</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="addresshandler_8hpp.html" title="Handles simple wildcard expansion for strings. ">addresshandler.hpp</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="taskinterface_8hpp.html" title="Interfaces with basic methods for iteration. ">taskinterface.hpp</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lexicographic-tropical-tropical-incls_8h.html" title="Headers for standalone shared library. ">lexicographic-tropical-tropical-incls.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lexicographic-tropical-tropical-funcs_8h.html" title="Convenience functors/functions for lexicographic&lt;tropical,tropical&gt; semiring. ">lexicographic-tropical-tropical-funcs.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fstio_8hpp.html" title="Contains convenience functions to write and read fsts. ">fstio.hpp</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fstutils_8hpp.html" title="Utilites to extract vocabulary, pseudo-determinize lattices and build substring transducers. ">fstutils.hpp</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fstutils_8mapper_8hpp.html" title="Generalized weight mapper functor. ">fstutils.mapper.hpp</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fstutils_8multiunion_8hpp.html" title="Implementations of multiple fst unions. ">fstutils.multiunion.hpp</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//KenLM</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;lm/model.hh&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fstutils_8multiepsiloncompose_8hpp.html" title="Multiepsilon composition. ">fstutils.multiepsiloncompose.hpp</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="defs_8grammar_8hpp.html" title="Contains definitions for cykparser data and task. ">defs.grammar.hpp</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="defs_8ssgrammar_8hpp.html" title="Contains definitions for sentence-specific grammar data and task. ">defs.ssgrammar.hpp</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="defs_8cykparser_8hpp.html" title="Contains definitions for cykparser data and task. ">defs.cykparser.hpp</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="data_8stats_8hpp.html" title="Relative to Stats across the pipeline. ">data.stats.hpp</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="data_8grammar_8hpp.html" title="Contains structures and classes for GrammarData. ">data.grammar.hpp</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="data_8lm_8hpp.html" title="Implementation of a language model data structure using kenlm. ">data.lm.hpp</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fstutils_8applylmonthefly_8hpp.html" title="Contains implementation of ApplyLanguageModelOnTheFly. ">fstutils.applylmonthefly.hpp</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="data_8ssgrammar_8hpp.html" title="Contains sentence-specific grammar data. ">data.ssgrammar.hpp</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="data_8cykparser_8hpp.html" title="Contains structures and classes for GrammarData. ">data.cykparser.hpp</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="task_8grammar_8hpp.html" title="Describes class GrammarTask. ">task.grammar.hpp</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="task_8ssgrammar_8hpp.html" title="Contains implementation for sentence-specific grammar task. ">task.ssgrammar.hpp</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="task_8cykparser_8hpp.html" title="Contains cyk parser implementation. ">task.cykparser.hpp</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="task_8loadlm_8hpp.html" title="Implementation of a language model task. ">task.loadlm.hpp</a>&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="task_8hifst_8hpp.html" title="Contains structures and classes for hifst task (target lattice building) ">task.hifst.hpp</a>&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="data-main_8hifst_8hpp.html" title="Data object for hifst or related tools. ">data-main.hifst.hpp</a>&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">namespace </span>bfs = boost::filesystem;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">namespace </span>uf = ucam::fsttools;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">namespace </span>uh =  ucam::hifst;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="code" href="classHifstTest.html">   73</a></span>&#160;<span class="keyword">class </span><a class="code" href="classHifstTest.html" title="hifst test class for google test fixtures ">HifstTest</a> : <span class="keyword">public</span> testing::Test {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; <span class="keyword">protected</span>:  <span class="comment">// You should make the members protected s.t. they can be</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">// accessed from sub-classes.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// virtual void SetUp() will be called before each test is run.  You</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// should define it if you need to initialize the variables.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// Otherwise, this can be skipped.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="code" href="classHifstTest.html#a3a610d179cf35ec5c7ba1eaa5570ac5f">   80</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classHifstTest.html#a3a610d179cf35ec5c7ba1eaa5570ac5f">SetUp</a>() {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#ac8e7fae483175bcf8ba1194e33e2cfc0">HifstConstants::kGrammarLoad</a>] = std::string ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#adb227935a2832e138791e6c2fc0c338c">HifstConstants::kGrammarStorepatterns</a>] = std::string ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a6783c82f483a3a7ceda8ca2f61dbc4c0">HifstConstants::kGrammarStorentorder</a>] = std::string ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a05365c1afbbd2dcd3625dd0671a94da2">HifstConstants::kGrammarFeatureweights</a>] = std::string ( <span class="stringliteral">&quot;1&quot;</span> );</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#aa5798e08bcae3d2869a15cd2e0f3ea9f">HifstConstants::kSsgrammarStore</a>] = std::string ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#aa8a006f7a5dc82ada8c0c8d551cc6b03">HifstConstants::kSsgrammarAddoovsEnable</a>] = std::string (<span class="stringliteral">&quot;no&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#ab2508df5e96dbe630eac2979ba80d5c2">HifstConstants::kSsgrammarAddoovsSourcedeletions</a>] = std::string (<span class="stringliteral">&quot;no&quot;</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a772be32aafab6e676cd299d07cd75b53">HifstConstants::kCykparserHrmaxheight</a>] = unsigned ( 10 );</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a2c3b14542baf5400215195a2f951a20e">HifstConstants::kCykparserHmax</a>] = std::string ( <span class="stringliteral">&quot;X,10&quot;</span> );</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#af6ac04949b45422e86ec539658e754d5">HifstConstants::kCykparserHmin</a>] = std::string ( <span class="stringliteral">&quot;X,0&quot;</span> );</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a56b3e911d8a68a94f426a33b8ee256a0">HifstConstants::kCykparserNtexceptionsmaxspan</a>] = std::string ( <span class="stringliteral">&quot;S&quot;</span> );</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>] = std::string ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a3c096679e72a409ec248d55c5f3f13ea">HifstConstants::kHifstLocalpruneEnable</a>] = std::string (<span class="stringliteral">&quot;no&quot;</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a52d9562de3221af2ed3a06e4bfa873de">HifstConstants::kHifstLocalpruneConditions</a>] = std::string ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a7c40ef9ec5e9b55f4a8fa0080cdb4e81">HifstConstants::kHifstLocalpruneLmLoad</a>] = std::string (<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a936b53622279b036bb4b107ed2002566">HifstConstants::kHifstLocalpruneLmFeatureweights</a>] = unsigned (1);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a1e4c5d622f7fe98d69e74a4394e56be3">HifstConstants::kHifstLocalpruneLmWordpenalty</a>] = unsigned (0);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a6060cd130e5aa3184ad3126afd6055bb">HifstConstants::kHifstLocalpruneNumstates</a>] = unsigned ( 1000 );</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a32ad4611ce726339ff22c4716e818781">HifstConstants::kHifstPrune</a>] = float ( 1.0 );</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a24949641c40d5c24f2efc1506dcb5f65">HifstConstants::kHifstUsepdt</a>] = std::string (<span class="stringliteral">&quot;no&quot;</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a786981fc7a11e0997b4453499a6b9b46">HifstConstants::kHifstRtnopt</a>] = std::string (<span class="stringliteral">&quot;yes&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a4bd136ebfd7e86728978a00b567368f1">HifstConstants::kHifstWritertn</a>] = std::string ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#acf9ecf3221012de16183e241010ed663">HifstConstants::kHifstAlilatsmode</a>] = std::string (<span class="stringliteral">&quot;no&quot;</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>[<a class="code" href="namespaceHifstConstants.html#a8591438723983a750e7cdd93e890db8b">HifstConstants::kHifstOptimizecells</a>] = std::string (<span class="stringliteral">&quot;yes&quot;</span>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keyword">const</span> <a class="code" href="classucam_1_1util_1_1RegistryPO.html">uu::RegistryPO</a> rg ( <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a> );</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">//We need to generate some rules. It is easy to do so with GrammarTask, so we do it. We need to keep these tasks during all the lifespan of the tests, though.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="classHifstTest.html#a549fb8a63050780822924bddcd18ed1b">gt_</a> = <span class="keyword">new</span> <a class="code" href="classucam_1_1hifst_1_1GrammarTask.html" title="Task class that loads a grammar into memory. ">uh::GrammarTask&lt;uh::HifstTaskData&lt;&gt;</a> &gt; ( rg );</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;X 3 3 0&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;S S_X S_X 0&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;X 4 4 0&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;X 5 5 0&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;X 1 1 0&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;X 2 2 0&quot;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;       &lt;&lt; endl;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;X 3_4 3_4 0&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;X 3_X_5 3_X_5 0&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;S X X 0&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="classHifstTest.html#a549fb8a63050780822924bddcd18ed1b">gt_</a>-&gt;<a class="code" href="classucam_1_1hifst_1_1GrammarTask.html#a400bc3460790eda03bf5d76291a9da79" title="Loads rules from a grammar file. ">load</a> ( ss );</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a9e77721278349d1304ff4413cde6f413" title="Contains translation grammar. ">grammar</a> = <a class="code" href="classHifstTest.html#a549fb8a63050780822924bddcd18ed1b">gt_</a>-&gt;<a class="code" href="classucam_1_1hifst_1_1GrammarTask.html#ac7d0613479777136eb7f08823de0f35c" title="Returns GrammarData. ">getGrammarData</a>();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; 9; ++k ) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <a class="code" href="logger_8boost__log_8hpp.html#adf127ca2262cc160830da49c37d04e85">LINFO</a> ( <span class="stringliteral">&quot;RULE #&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a9e77721278349d1304ff4413cde6f413" title="Contains translation grammar. ">grammar</a>-&gt;<a class="code" href="structucam_1_1hifst_1_1GrammarData.html#af4d46f784994a05368e00b3b9c80d597" title="Gets a rule indexed by idx. Rule format: LHS RHSSource RHSTarget weight. ">getRule</a> ( k ) &lt;&lt; <span class="stringliteral">&quot;, real_idx=&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;              <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a9e77721278349d1304ff4413cde6f413" title="Contains translation grammar. ">grammar</a>-&gt;<a class="code" href="structucam_1_1hifst_1_1GrammarData.html#a3e08646b9b374a12caf9123877fc0653" title="Gets the real position (line) in the (potentially unsorted) file. ">getIdx</a> ( k ) );</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">// Now we prepare manually some instance-patterns</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a41abd0335f98bb95dfabed6bf2385a64" title="Sentence index. ">sidx</a> = 0;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a9e777e2ec61010883584ea5fd4faf5ff">sentence</a> = <span class="stringliteral">&quot;1 3 4 5 2&quot;</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a40c19b67061712d1d412e975814dfe83">hpinstances</a>[<span class="stringliteral">&quot;1&quot;</span>].push_back ( pair&lt;unsigned, unsigned&gt; ( 0, 0 ) );</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a40c19b67061712d1d412e975814dfe83">hpinstances</a>[<span class="stringliteral">&quot;3&quot;</span>].push_back ( pair&lt;unsigned, unsigned&gt; ( 1, 0 ) );</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a40c19b67061712d1d412e975814dfe83">hpinstances</a>[<span class="stringliteral">&quot;4&quot;</span>].push_back ( pair&lt;unsigned, unsigned&gt; ( 2, 0 ) );</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a40c19b67061712d1d412e975814dfe83">hpinstances</a>[<span class="stringliteral">&quot;5&quot;</span>].push_back ( pair&lt;unsigned, unsigned&gt; ( 3, 0 ) );</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a40c19b67061712d1d412e975814dfe83">hpinstances</a>[<span class="stringliteral">&quot;2&quot;</span>].push_back ( pair&lt;unsigned, unsigned&gt; ( 4, 0 ) );</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a40c19b67061712d1d412e975814dfe83">hpinstances</a>[<span class="stringliteral">&quot;3_4&quot;</span>].push_back ( pair&lt;unsigned, unsigned&gt; ( 1, 1 ) );</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a40c19b67061712d1d412e975814dfe83">hpinstances</a>[<span class="stringliteral">&quot;3_X_5&quot;</span>].push_back ( pair&lt;unsigned, unsigned&gt; ( 1, 2 ) );</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a40c19b67061712d1d412e975814dfe83">hpinstances</a>[<span class="stringliteral">&quot;X_X&quot;</span>].push_back ( pair&lt;unsigned, unsigned&gt; ( 0, 1 ) );</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>.<a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html#a40c19b67061712d1d412e975814dfe83">hpinstances</a>[<span class="stringliteral">&quot;X&quot;</span>].push_back ( pair&lt;unsigned, unsigned&gt; ( 0, 0 ) );</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// Prepare sentence-specific grammar.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="classHifstTest.html#a9a93cba9e1e6bc301e52cc71effbe364">ssgt_</a> = <span class="keyword">new</span> <a class="code" href="classucam_1_1hifst_1_1SentenceSpecificGrammarTask.html" title="This class uses instantiated patterns to analyze the grammar and deliver two hashes providing candida...">uh::SentenceSpecificGrammarTask&lt;uh::HifstTaskData&lt;&gt;</a> &gt; ( rg );</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="classHifstTest.html#a9a93cba9e1e6bc301e52cc71effbe364">ssgt_</a>-&gt;<a class="code" href="classucam_1_1hifst_1_1SentenceSpecificGrammarTask.html#a2ad761a072a3745b1e822b90e95ca206" title="run method, given a grammar and instantiated patterns, creates and returns the hashes ...">run</a> ( <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a> );</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// Run cyk parse</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="classHifstTest.html#a4a16ee03bff077bfa1145b178e866b45">cyk_</a> = <span class="keyword">new</span> <a class="code" href="classucam_1_1hifst_1_1CYKParserTask.html" title="Implements cyk+ parser. ">uh::CYKParserTask&lt;uh::HifstTaskData&lt;&gt;</a> &gt; ( rg );</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="classHifstTest.html#a4a16ee03bff077bfa1145b178e866b45">cyk_</a>-&gt;<a class="code" href="classucam_1_1hifst_1_1CYKParserTask.html#aaa1f47e66708d9d76814b6cd8a79d33d" title="Runs the parsing algorithm. ">run</a> ( <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a> );</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="logger_8boost__log_8hpp.html#adf127ca2262cc160830da49c37d04e85">LINFO</a> ( <span class="stringliteral">&quot;Setup finished!&quot;</span> );</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// virtual void TearDown() will be called after each test is run.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">// You should define it if there is cleanup work to do.  Otherwise,</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// you don&#39;t have to provide it.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="code" href="classHifstTest.html#a4b0b8c0de2cf38330df9426560636709">  145</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classHifstTest.html#a4b0b8c0de2cf38330df9426560636709">TearDown</a>() {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="logger_8boost__log_8hpp.html#adf127ca2262cc160830da49c37d04e85">LINFO</a> ( <span class="stringliteral">&quot;Teardown...&quot;</span> );</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classHifstTest.html#a549fb8a63050780822924bddcd18ed1b">gt_</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classHifstTest.html#a9a93cba9e1e6bc301e52cc71effbe364">ssgt_</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classHifstTest.html#a4a16ee03bff077bfa1145b178e866b45">cyk_</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">// Declares the variables your tests want to use.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">  153</a></span>&#160;  <a class="code" href="classucam_1_1hifst_1_1HifstTaskData.html">uh::HifstTaskData&lt;&gt;</a> <a class="code" href="classHifstTest.html#a8ac65771c00b8c6ba3f14784410c9897">d_</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">  154</a></span>&#160;  unordered_map&lt;std::string, boost::any&gt; <a class="code" href="classHifstTest.html#aaa98abd5cbeb9e4f3a78961801122a12">v_</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="code" href="classHifstTest.html#a549fb8a63050780822924bddcd18ed1b">  156</a></span>&#160;  <a class="code" href="classucam_1_1hifst_1_1GrammarTask.html" title="Task class that loads a grammar into memory. ">uh::GrammarTask&lt;uh::HifstTaskData&lt;&gt;</a> &gt; *<a class="code" href="classHifstTest.html#a549fb8a63050780822924bddcd18ed1b">gt_</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="code" href="classHifstTest.html#a9a93cba9e1e6bc301e52cc71effbe364">  157</a></span>&#160;  <a class="code" href="classucam_1_1hifst_1_1SentenceSpecificGrammarTask.html" title="This class uses instantiated patterns to analyze the grammar and deliver two hashes providing candida...">uh::SentenceSpecificGrammarTask&lt;uh::HifstTaskData&lt;&gt;</a> &gt; *<a class="code" href="classHifstTest.html#a9a93cba9e1e6bc301e52cc71effbe364">ssgt_</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="code" href="classHifstTest.html#a4a16ee03bff077bfa1145b178e866b45">  158</a></span>&#160;  <a class="code" href="classucam_1_1hifst_1_1CYKParserTask.html" title="Implements cyk+ parser. ">uh::CYKParserTask&lt;uh::HifstTaskData&lt;&gt;</a> &gt; *<a class="code" href="classHifstTest.html#a4a16ee03bff077bfa1145b178e866b45">cyk_</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;};</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#a48246cba9d45a13b527c3e5be7307f99">  165</a></span>&#160;<a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#a48246cba9d45a13b527c3e5be7307f99" title="Basic test for HifstTask. ">TEST_F</a> ( <a class="code" href="classHifstTest.html" title="hifst test class for google test fixtures ">HifstTest</a>, basic_translation ) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  v_[<a class="code" href="namespaceHifstConstants.html#aba43e5c6dd74c9d9bdb104a2d2eea99f">HifstConstants::kHifstReplacefstbyarcNonterminals</a>] = std::string ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  v_[<a class="code" href="namespaceHifstConstants.html#a69711b4bf2ce85e28695130f54fe924f">HifstConstants::kHifstReplacefstbyarcNumstates</a>] = unsigned (</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        std::numeric_limits&lt;unsigned&gt;::max() );</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  v_[<a class="code" href="namespaceHifstConstants.html#aab16f961802fb95607f5b28bd90f1710">HifstConstants::kHifstReplacefstbyarcExceptions</a>] = std::string ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keyword">const</span> <a class="code" href="classucam_1_1util_1_1RegistryPO.html">uu::RegistryPO</a> rg ( v_ );</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="logger_8boost__log_8hpp.html#adf127ca2262cc160830da49c37d04e85">LINFO</a> ( <span class="stringliteral">&quot;Number of inst:&quot;</span> &lt;&lt; d_.hpinstances.size() );</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  EXPECT_TRUE ( d_.cykdata != NULL );</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">//Finally, build translation</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="classucam_1_1hifst_1_1HiFSTTask.html" title="Core of Hifst. Implements the lattice-building procedure for a cyk-parsed sentence. ">uh::HiFSTTask&lt;uh::HifstTaskData&lt;&gt;</a> &gt; hifst ( rg );</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  hifst.<a class="code" href="classucam_1_1hifst_1_1HiFSTTask.html#a8b479055293c01b82b64c1f52390083d" title="Runs the lattice building procedure. ">run</a> ( d_ );</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">//Test output.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  EXPECT_TRUE ( d_.fsts[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>] != NULL );</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  std::stringstream ss;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="namespacefst.html#a63eb5e1f918b40e4888560d506dc453a" title="Trivial function that outputs all the hypothesis in the lattice with its cost. ">fst::printstrings</a> ( *<span class="keyword">static_cast&lt;</span>fst::VectorFst&lt;fst::LexStdArc&gt; *<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                      (d_.fsts[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>]), &amp;ss );</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  EXPECT_EQ ( ss.str(),</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;              <span class="stringliteral">&quot;1 3 4 5 2 || 1 3 4 5 2 || 0,0\n&quot;</span> );</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;};</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#a60e7a98d7cc466862534185b4b0207a4">  189</a></span>&#160;<a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#a48246cba9d45a13b527c3e5be7307f99" title="Basic test for HifstTask. ">TEST_F</a> ( <a class="code" href="classHifstTest.html" title="hifst test class for google test fixtures ">HifstTest</a>, basic_translation2 ) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  v_[<a class="code" href="namespaceHifstConstants.html#a69711b4bf2ce85e28695130f54fe924f">HifstConstants::kHifstReplacefstbyarcNumstates</a>] = unsigned (</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        std::numeric_limits&lt;unsigned&gt;::max() );</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  v_[<a class="code" href="namespaceHifstConstants.html#aba43e5c6dd74c9d9bdb104a2d2eea99f">HifstConstants::kHifstReplacefstbyarcNonterminals</a>] = std::string ( <span class="stringliteral">&quot;X&quot;</span> );</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  v_[<a class="code" href="namespaceHifstConstants.html#aab16f961802fb95607f5b28bd90f1710">HifstConstants::kHifstReplacefstbyarcExceptions</a>] = std::string ( <span class="stringliteral">&quot;S&quot;</span> );</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keyword">const</span> <a class="code" href="classucam_1_1util_1_1RegistryPO.html">uu::RegistryPO</a> rg ( v_ );</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <a class="code" href="logger_8boost__log_8hpp.html#adf127ca2262cc160830da49c37d04e85">LINFO</a> ( <span class="stringliteral">&quot;Number of inst:&quot;</span> &lt;&lt; d_.hpinstances.size() );</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  EXPECT_TRUE ( d_.cykdata != NULL );</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">//Finally, build translation</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <a class="code" href="classucam_1_1hifst_1_1HiFSTTask.html" title="Core of Hifst. Implements the lattice-building procedure for a cyk-parsed sentence. ">uh::HiFSTTask&lt;uh::HifstTaskData&lt;&gt;</a> &gt; hifst ( rg );</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  hifst.<a class="code" href="classucam_1_1hifst_1_1HiFSTTask.html#a8b479055293c01b82b64c1f52390083d" title="Runs the lattice building procedure. ">run</a> ( d_ );</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">//Test output.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  EXPECT_TRUE ( d_.fsts[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>] != NULL );</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  std::stringstream ss;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="namespacefst.html#a63eb5e1f918b40e4888560d506dc453a" title="Trivial function that outputs all the hypothesis in the lattice with its cost. ">fst::printstrings</a> ( * <span class="keyword">static_cast&lt;</span>fst::VectorFst&lt;fst::LexStdArc&gt; *<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                      (d_.fsts[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>]), &amp;ss );</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  EXPECT_EQ ( ss.str(),</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;              <span class="stringliteral">&quot;1 3 4 5 2 || 1 3 4 5 2 || 0,0\n1 3 4 5 2 || 1 3 4 5 2 || 0,0\n1 3 4 5 2 || 1 3 4 5 2 || 0,0\n&quot;</span> );</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;};</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#ae34b12e8b2f8e1211861aaf4d7d26abe">  213</a></span>&#160;<a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#a48246cba9d45a13b527c3e5be7307f99" title="Basic test for HifstTask. ">TEST_F</a> ( <a class="code" href="classHifstTest.html" title="hifst test class for google test fixtures ">HifstTest</a>, basic_translation3 ) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="classucam_1_1util_1_1oszfstream.html" title="Wrapper stream class that writes to pipes, text files or gzipped files. ">uu::oszfstream</a> o ( <span class="stringliteral">&quot;mylm&quot;</span> );</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    o &lt;&lt; endl;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;\\data\\&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;ngram 1=5&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;ngram 2=2&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;ngram 3=1&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    o &lt;&lt; endl;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;\\1-grams:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;-1\t3\t0&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;-10\t4\t0&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;-100\t5\t0&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;-1000\t&lt;/s&gt;\t0&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;0\t&lt;s&gt;\t0&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    o &lt;&lt; endl;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;\\2-grams:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;-10000\t3 4\t0&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;-100000\t4 &lt;/s&gt;\t0&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    o &lt;&lt; endl;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;\\3-grams:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;-1000000\t3 4 &lt;/s&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    o &lt;&lt; endl;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;\\end\\&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    o.<a class="code" href="classucam_1_1util_1_1oszfstream.html#a245211eee5ec1288934d32984457d338" title="Closes the file. ">close</a>();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  v_[<a class="code" href="namespaceHifstConstants.html#a922a20cdf8305f360766bea0e7790127">HifstConstants::kLmFeatureweights</a>] = std::string ( <span class="stringliteral">&quot;1.0&quot;</span> );</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  v_[<a class="code" href="namespaceHifstConstants.html#aa42b4603e57486c7d8509f7495f776fc">HifstConstants::kLmLoad</a>] = std::string ( <span class="stringliteral">&quot;mylm&quot;</span> );</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  v_[<a class="code" href="namespaceHifstConstants.html#a9e5c8ac3695644e1b68f452186684ad2">HifstConstants::kLmWordmap</a>] = std::string (<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  v_[<a class="code" href="namespaceHifstConstants.html#a69711b4bf2ce85e28695130f54fe924f">HifstConstants::kHifstReplacefstbyarcNumstates</a>] = unsigned (</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        std::numeric_limits&lt;unsigned&gt;::max() );</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  v_[<a class="code" href="namespaceHifstConstants.html#aba43e5c6dd74c9d9bdb104a2d2eea99f">HifstConstants::kHifstReplacefstbyarcNonterminals</a>] = std::string ( <span class="stringliteral">&quot;X&quot;</span> );</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  v_[<a class="code" href="namespaceHifstConstants.html#aab16f961802fb95607f5b28bd90f1710">HifstConstants::kHifstReplacefstbyarcExceptions</a>] = std::string ( <span class="stringliteral">&quot;S&quot;</span> );</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keyword">const</span> <a class="code" href="classucam_1_1util_1_1RegistryPO.html">uu::RegistryPO</a> rg ( v_ );</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <a class="code" href="logger_8boost__log_8hpp.html#adf127ca2262cc160830da49c37d04e85">LINFO</a> ( <span class="stringliteral">&quot;Number of inst:&quot;</span> &lt;&lt; d_.hpinstances.size() );</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  EXPECT_TRUE ( d_.cykdata != NULL );</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">//Finally, build translation</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <a class="code" href="classucam_1_1fsttools_1_1LoadLanguageModelTask.html" title="Language model loader task, loads a language model wrapping it in a class to provide. ">uf::LoadLanguageModelTask&lt;uh::HifstTaskData&lt;&gt;</a> &gt; loadlm ( rg );</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <a class="code" href="classucam_1_1hifst_1_1HiFSTTask.html" title="Core of Hifst. Implements the lattice-building procedure for a cyk-parsed sentence. ">uh::HiFSTTask&lt;uh::HifstTaskData&lt;&gt;</a> &gt; hifst ( rg );</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  loadlm.<a class="code" href="classucam_1_1fsttools_1_1LoadLanguageModelTask.html#a1d1492542bc40e72a2503864cfa4409b" title="Method inherited from TaskInterface. Loads the language model and stores in lm data structure...">run</a> ( d_ );</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  hifst.<a class="code" href="classucam_1_1hifst_1_1HiFSTTask.html#a8b479055293c01b82b64c1f52390083d" title="Runs the lattice building procedure. ">run</a> ( d_ );</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">//Test output.</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  EXPECT_TRUE ( d_.fsts[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>] != NULL );</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  std::stringstream ss;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <a class="code" href="namespacefst.html#a63eb5e1f918b40e4888560d506dc453a" title="Trivial function that outputs all the hypothesis in the lattice with its cost. ">fst::printstrings</a> ( * <span class="keyword">static_cast&lt;</span>fst::VectorFst&lt;fst::LexStdArc&gt; *<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                      (d_.fsts[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>]), &amp;ss );</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">//Hypothesis &lt;s&gt; 3 4 5 &lt;/s&gt; yields -11101</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="comment">//log2ln -11101=25560.99711732690113819501, apparently rounded somewhere to 25561.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  EXPECT_EQ ( ss.str(),</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;              <span class="stringliteral">&quot;1 3 4 5 2 || 1 3 4 5 2 || 25561,0\n1 3 4 5 2 || 1 3 4 5 2 || 25561,0\n1 3 4 5 2 || 1 3 4 5 2 || 25561,0\n&quot;</span> );</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  bfs::remove ( bfs::path ( <span class="stringliteral">&quot;mylm&quot;</span> ) );</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;};</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#aeaf3c26df65460e8008b2d16aeac7fce">  271</a></span>&#160;<a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#a48246cba9d45a13b527c3e5be7307f99" title="Basic test for HifstTask. ">TEST_F</a> ( <a class="code" href="classHifstTest.html" title="hifst test class for google test fixtures ">HifstTest</a>, alignment ) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  unordered_map&lt;std::string, boost::any&gt; v = v_;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  v[<a class="code" href="namespaceHifstConstants.html#aba43e5c6dd74c9d9bdb104a2d2eea99f">HifstConstants::kHifstReplacefstbyarcNonterminals</a>] = std::string ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  v[<a class="code" href="namespaceHifstConstants.html#a69711b4bf2ce85e28695130f54fe924f">HifstConstants::kHifstReplacefstbyarcNumstates</a>] = unsigned (</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        std::numeric_limits&lt;unsigned&gt;::max() );</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  v[<a class="code" href="namespaceHifstConstants.html#aab16f961802fb95607f5b28bd90f1710">HifstConstants::kHifstReplacefstbyarcExceptions</a>] = std::string ( <span class="stringliteral">&quot;S&quot;</span> );</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  v[<a class="code" href="namespaceHifstConstants.html#acf9ecf3221012de16183e241010ed663">HifstConstants::kHifstAlilatsmode</a>] = std::string (<span class="stringliteral">&quot;yes&quot;</span>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keyword">const</span> <a class="code" href="classucam_1_1util_1_1RegistryPO.html">uu::RegistryPO</a> rg ( v );</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="logger_8boost__log_8hpp.html#adf127ca2262cc160830da49c37d04e85">LINFO</a> ( <span class="stringliteral">&quot;Number of inst:&quot;</span> &lt;&lt; d_.hpinstances.size() );</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  EXPECT_TRUE ( d_.cykdata != NULL );</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">//Finally, build translation</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="classucam_1_1hifst_1_1HiFSTTask.html" title="Core of Hifst. Implements the lattice-building procedure for a cyk-parsed sentence. ">uh::HiFSTTask&lt;uh::HifstTaskData&lt;&gt;</a> &gt; hifst ( rg );</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  hifst.<a class="code" href="classucam_1_1hifst_1_1HiFSTTask.html#a8b479055293c01b82b64c1f52390083d" title="Runs the lattice building procedure. ">run</a> ( d_ );</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">//Test output.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  EXPECT_TRUE ( d_.fsts[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>] != NULL );</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">  std::stringstream ss;</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">  printstrings ( * static_cast&lt;fst::VectorFst&lt;fst::LexStdArc&gt; *&gt;(d_.fsts[HifstConstants::kHifstLatticeStore]), &amp;ss );</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">  EXPECT_EQ ( ss.str(),</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">                &quot;5 9 1 2 3 2 4 2 6 2 || 1 3 4 5 2 || 0,0\n5 9 7 2 4 2 6 2 || 1 3 4 5 2 || 0,0\n5 9 3 8 2 6 2 || 1 3 4 5 2 || 0,0\n&quot;);</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">              //&quot;5 9 7 2 4 2 6 2 || 1 3 4 5 2 || 0,0\n5 9 3 8 2 6 2 || 1 3 4 5 2 || 0,0\n5 9 1 2 3 2 4 2 6 2 || 1 3 4 5 2 || 0,0\n&quot; );</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">  //  FstWrite(*d_.fsts[kHifstLatticeStore],&quot;jajaja.fst&quot;);</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  fst::VectorFst&lt;fst::LexStdArc&gt; *a = <span class="keyword">new</span> fst::VectorFst&lt;fst::LexStdArc&gt;;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  fst::VectorFst&lt;fst::LexStdArc&gt; *b = <span class="keyword">new</span> fst::VectorFst&lt;fst::LexStdArc&gt;;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  fst::VectorFst&lt;fst::LexStdArc&gt; *c = <span class="keyword">new</span> fst::VectorFst&lt;fst::LexStdArc&gt;;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  fst::string2fst&lt;fst::LexStdArc&gt; (<span class="stringliteral">&quot;5 9 1 2 3 2 4 2 6 2&quot;</span>, a);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  fst::string2fst&lt;fst::LexStdArc&gt; (<span class="stringliteral">&quot;5 9 7 2 4 2 6 2&quot;</span>, b);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  fst::string2fst&lt;fst::LexStdArc&gt; (<span class="stringliteral">&quot;5 9 3 8 2 6 2&quot;</span>, c);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <a class="code" href="classfst_1_1MultiUnionReplace.html" title="This class creates the Union of an arbitrarily large number of fsts. This implementation uses one RTN...">fst::MultiUnionReplace&lt;fst::LexStdArc &gt;</a> mur;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  mur.<a class="code" href="classfst_1_1MultiUnionReplace.html#ae13b5a76cc5298552c3fc1e4a052e7a4" title="Adds an fst to the list. ">Add</a> (a);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  mur.Add (b);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  mur.Add (c);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  fst::VectorFst&lt;fst::LexStdArc&gt; *j = mur();</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  fst::Determinize (fst::RmEpsilonFst&lt;fst::LexStdArc&gt; (*j), j);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  fst::Minimize (j);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  fst::RmEpsilon (j);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  fst::Project (<span class="keyword">static_cast&lt;</span>fst::VectorFst&lt;fst::LexStdArc&gt; *<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                (d_.fsts[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>]), fst::PROJECT_INPUT);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  fst::Determinize (fst::RmEpsilonFst&lt;fst::LexStdArc&gt;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    (*<span class="keyword">static_cast&lt;</span>fst::VectorFst&lt;fst::LexStdArc&gt; *<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                     (d_.fsts[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>]) ),</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    static_cast&lt;fst::VectorFst&lt;fst::LexStdArc&gt; *&gt;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    (d_.fsts[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>]) );</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  fst::Minimize (<span class="keyword">static_cast&lt;</span>fst::VectorFst&lt;fst::LexStdArc&gt; *<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                 (d_.fsts[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>]) );</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  fst::RmEpsilon (<span class="keyword">static_cast&lt;</span>fst::VectorFst&lt;fst::LexStdArc&gt; *<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                  (d_.fsts[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>]) );</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  EXPECT_EQ (Equivalent (*<span class="keyword">static_cast&lt;</span>fst::VectorFst&lt;fst::LexStdArc&gt; *<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                         (d_.fsts[<a class="code" href="namespaceHifstConstants.html#a69fac97352da1de0d0e585e6ef6c31d2">HifstConstants::kHifstLatticeStore</a>]), *j), <span class="keyword">true</span>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keyword">delete</span> j;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;};</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno"><a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#a81146b2c087fbfa28252427e28493766">  325</a></span>&#160;<a class="code" href="address_8gtest_8cpp.html#aa792ce4e48d480e9db2126fd4137eb77" title="Tests wildcard expansion with an integer. ">TEST</a> ( HifstTest2, localconditions ) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keyword">using</span> <a class="code" href="structucam_1_1hifst_1_1conditions.html" title="struct containing the elements that trigger local pruning. ">uh::conditions</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <a class="code" href="classucam_1_1hifst_1_1LocalPruningConditions.html" title="convenience class that takes care of local pruning conditions. Conditions are indexed by 1000*cc+y...">uh::LocalPruningConditions</a> lpc;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">// Trigger pruning weight=9 if you are at or over cell (S,x,21) and your expanded cell lattice has +10000 states.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  lpc.<a class="code" href="classucam_1_1hifst_1_1LocalPruningConditions.html#abe77ee616ae7a86e17d6364085aea856" title="Add condition. ">add</a> ( conditions ( 1, 20, 10000, 9.0f ) );</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="comment">// Trigger pruning weight=8.5 if you are at or over cell (X,x,11) and your expanded cell lattice has +1000 states.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  lpc.<a class="code" href="classucam_1_1hifst_1_1LocalPruningConditions.html#abe77ee616ae7a86e17d6364085aea856" title="Add condition. ">add</a> ( conditions ( 2, 10, 1000, 8.5f ) );</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">// Trigger pruning weight=10.5 if you are at or over cell (V,x,6) and your expanded cell lattice has +50 states.</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  lpc.<a class="code" href="classucam_1_1hifst_1_1LocalPruningConditions.html#abe77ee616ae7a86e17d6364085aea856" title="Add condition. ">add</a> ( conditions ( 3, 5, 50, 10.5f ) );</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// Trigger pruning weight=3.5 if you are at or over cell (V,x,6) and your expanded cell lattice has +500 states.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  lpc.<a class="code" href="classucam_1_1hifst_1_1LocalPruningConditions.html#abe77ee616ae7a86e17d6364085aea856" title="Add condition. ">add</a> (conditions (3, 5 , 500 , 3.5f ) );</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordtype">float</span> w = 0;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  EXPECT_EQ ( lpc ( 4, 20, 10000, w ), <span class="keyword">false</span> );</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  EXPECT_EQ ( lpc ( 1, 18, 10000, w ), <span class="keyword">false</span> );</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  EXPECT_EQ ( lpc ( 1, 19, 10000, w ), <span class="keyword">false</span> );</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  EXPECT_EQ ( lpc ( 1, 20, 10000, w ), <span class="keyword">true</span> );</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  EXPECT_EQ ( w, 9.0 );</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  EXPECT_EQ ( lpc ( 2, 10, 1000, w ), <span class="keyword">true</span> );</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  EXPECT_EQ ( w, 8.5 );</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  EXPECT_EQ ( lpc ( 3, 5, 50, w ), <span class="keyword">true</span> );</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  EXPECT_EQ ( w, 10.5 );</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  EXPECT_EQ ( lpc ( 3, 5, 499, w ), <span class="keyword">true</span> );</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  EXPECT_EQ ( w, 10.5 );</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  EXPECT_EQ ( lpc ( 3, 5, 500, w ), <span class="keyword">true</span> );</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  EXPECT_EQ ( w, 3.5 );</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  EXPECT_EQ ( lpc ( 3, 6, 500, w ), <span class="keyword">true</span> );</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  EXPECT_EQ ( w, 3.5 );</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  EXPECT_EQ ( lpc ( 3, 6, 300, w ), <span class="keyword">true</span> );</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  EXPECT_EQ ( w, 10.5 );</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">//Only 49 states</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  EXPECT_EQ ( lpc ( 3, 5, 49, w ), <span class="keyword">false</span> );</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="comment">//Below span=5</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  EXPECT_EQ ( lpc ( 3, 1, 490, w ), <span class="keyword">false</span> );</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">//Unexpected entries</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  EXPECT_EQ ( lpc ( 0, 0, 0, w ), <span class="keyword">false</span> );</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  EXPECT_EQ ( lpc ( std::numeric_limits&lt;unsigned&gt;::max(),</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    std::numeric_limits&lt;unsigned&gt;::max(), 0, w ), <span class="keyword">false</span> );</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  EXPECT_EQ ( lpc ( -1, -2, 0, w ), <span class="keyword">false</span> );</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <a class="code" href="classucam_1_1hifst_1_1LocalPruningConditions.html" title="convenience class that takes care of local pruning conditions. Conditions are indexed by 1000*cc+y...">uh::LocalPruningConditions</a> lpc2;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">//Given no conditions loaded, everything should be false!</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  EXPECT_EQ ( lpc2 ( 3, 5, 49, w ), <span class="keyword">false</span> );</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;};</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno"><a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#a3c6b4118ab4942ae63eadc0d3dd9a721">  379</a></span>&#160;<a class="code" href="address_8gtest_8cpp.html#aa792ce4e48d480e9db2126fd4137eb77" title="Tests wildcard expansion with an integer. ">TEST</a> ( HifstTest2, expandednumstatesrtn ) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <a class="code" href="classucam_1_1hifst_1_1ExpandedNumStatesRTN.html" title="Utility class that, given an RTN with root at (cc,x,y), estimates the number of states of an expanded...">uh::ExpandedNumStatesRTN&lt;fst::StdArc&gt;</a> test;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  fst::VectorFst&lt;fst::StdArc&gt; a, b;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  a.AddState();</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  a.AddState();</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  a.AddState();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  a.SetStart ( 0 );</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  a.SetFinal ( 2, fst::StdArc::Weight::One() );</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  a.AddArc ( 0, fst::StdArc ( <a class="code" href="global__decls_8hpp.html#a1e35b9fb56aa4d892554e9245b22c39e">APBASETAG</a> + 1 * <a class="code" href="global__decls_8hpp.html#a71c6908830dd7f665616db7ccd9942f7">APCCTAG</a> + 1 * <a class="code" href="global__decls_8hpp.html#ad7abf1eac20ecc6d4b5db42634c55254">APXTAG</a> + 1 * <a class="code" href="global__decls_8hpp.html#aa9cc5cd3dadd81dbd2874554d57f93ec">APYTAG</a>,</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                              <a class="code" href="global__decls_8hpp.html#a1e35b9fb56aa4d892554e9245b22c39e">APBASETAG</a> + 1, 0, 1 ) );</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  a.AddArc ( 1, fst::StdArc ( <a class="code" href="global__decls_8hpp.html#a1e35b9fb56aa4d892554e9245b22c39e">APBASETAG</a> + 1 * <a class="code" href="global__decls_8hpp.html#a71c6908830dd7f665616db7ccd9942f7">APCCTAG</a> + 1 * <a class="code" href="global__decls_8hpp.html#ad7abf1eac20ecc6d4b5db42634c55254">APXTAG</a> + 1 * <a class="code" href="global__decls_8hpp.html#aa9cc5cd3dadd81dbd2874554d57f93ec">APYTAG</a>,</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                              <a class="code" href="global__decls_8hpp.html#a1e35b9fb56aa4d892554e9245b22c39e">APBASETAG</a> + 1, 0, 2 ) );</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  b.AddState();</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  b.AddState();</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  b.SetStart ( 0 );</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  b.SetFinal ( 1, fst::StdArc::Weight::One() );</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  b.AddArc ( 0, fst::StdArc ( 1, 1, 0, 1 ) );</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  test.<a class="code" href="classucam_1_1hifst_1_1ExpandedNumStatesRTN.html#af8569c79a9dfa943a1e3284c880174fe" title="Estimates (expanded) number of states of rtn_[cc][x][y] Traverses arcs and and add number of states o...">update</a> ( 1, 1, 1, &amp;b );</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  test.<a class="code" href="classucam_1_1hifst_1_1ExpandedNumStatesRTN.html#af8569c79a9dfa943a1e3284c880174fe" title="Estimates (expanded) number of states of rtn_[cc][x][y] Traverses arcs and and add number of states o...">update</a> ( 1, 0, 1, &amp;a );</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  EXPECT_EQ ( test ( 1, 0, 1 ), 3 );</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#af2d6756d4efd002909ca06b95acf335e">  401</a></span>&#160;<a class="code" href="address_8gtest_8cpp.html#aa792ce4e48d480e9db2126fd4137eb77" title="Tests wildcard expansion with an integer. ">TEST</a> ( HifstTest2, replacefstbyarc ) {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="classucam_1_1hifst_1_1ReplaceFstByArc.html" title="Creates FST replacement or not depending on conditions. ">uh::ReplaceFstByArc&lt;fst::StdArc&gt;</a> x ( <span class="keyword">true</span>, 4 );</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  fst::VectorFst&lt;fst::StdArc&gt; a;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; 4; ++k ) a.AddState();</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  fst::VectorFst&lt;fst::StdArc&gt; *aux = x ( a, 1 );</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  ASSERT_TRUE ( aux == NULL );</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  a.AddState();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  aux = x ( a, 1 );</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  ASSERT_TRUE ( aux != NULL );</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  EXPECT_EQ ( aux-&gt;NumStates(), 2 );</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  ASSERT_EQ ( aux-&gt;NumArcs ( 0 ), 1 );</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keyword">delete</span> aux;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;}</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno"><a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#a860345f0f08a50e8e7ff1819f31015b9">  415</a></span>&#160;<a class="code" href="address_8gtest_8cpp.html#aa792ce4e48d480e9db2126fd4137eb77" title="Tests wildcard expansion with an integer. ">TEST</a> ( HifstTest2, manualreplacefstbyarc ) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="namespaceucam_1_1hifst.html#a68e3a0e387869e0f295d588f22eeaf5d">uh::grammar_inversecategories_t</a> vcat;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  vcat[1] = <span class="stringliteral">&quot;S&quot;</span>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  vcat[2] = <span class="stringliteral">&quot;X&quot;</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  unordered_set&lt;std::string&gt; replacefstbyarc;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  replacefstbyarc.insert ( <span class="stringliteral">&quot;X&quot;</span> );</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  unordered_set&lt;std::string&gt; replacefstbyarcexceptions;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  replacefstbyarcexceptions.insert (<span class="stringliteral">&quot;S&quot;</span>);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  fst::VectorFst&lt;fst::StdArc&gt; a;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; 2; ++k ) a.AddState();</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="classucam_1_1hifst_1_1ManualReplaceFstByArc.html" title="Creates FST replacement or not depending on conditions including program options. ...">uh::ManualReplaceFstByArc&lt;fst::StdArc&gt;</a> x ( vcat, replacefstbyarc, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    fst::StdArc::Label label1 = <a class="code" href="global__decls_8hpp.html#a1e35b9fb56aa4d892554e9245b22c39e">APBASETAG</a> + 1 * <a class="code" href="global__decls_8hpp.html#a71c6908830dd7f665616db7ccd9942f7">APCCTAG</a> + 1;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    fst::VectorFst&lt;fst::StdArc&gt; *aux = x ( a, label1 );</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    ASSERT_TRUE ( aux == NULL );</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    fst::StdArc::Label label2 = <a class="code" href="global__decls_8hpp.html#a1e35b9fb56aa4d892554e9245b22c39e">APBASETAG</a> + 2 * APCCTAG + 1;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    aux = x ( a, label2 );</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    ASSERT_TRUE ( aux != NULL );</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    EXPECT_EQ ( aux-&gt;NumStates(), 2 );</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keyword">delete</span> aux;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="classucam_1_1hifst_1_1ManualReplaceFstByArc.html" title="Creates FST replacement or not depending on conditions including program options. ...">uh::ManualReplaceFstByArc&lt;fst::StdArc&gt;</a> x ( vcat, replacefstbyarc, <span class="keyword">true</span>, 0);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    fst::StdArc::Label label1 = <a class="code" href="global__decls_8hpp.html#a1e35b9fb56aa4d892554e9245b22c39e">APBASETAG</a> + 1 * <a class="code" href="global__decls_8hpp.html#a71c6908830dd7f665616db7ccd9942f7">APCCTAG</a> + 1;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    fst::VectorFst&lt;fst::StdArc&gt; *aux = x ( a, label1 );</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    ASSERT_TRUE ( aux != NULL );</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    EXPECT_EQ ( aux-&gt;NumStates(), 2 );</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keyword">delete</span> aux;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    fst::StdArc::Label label2 = <a class="code" href="global__decls_8hpp.html#a1e35b9fb56aa4d892554e9245b22c39e">APBASETAG</a> + 2 * APCCTAG + 1;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    aux = x ( a, label2 );</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    ASSERT_TRUE ( aux != NULL );</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    EXPECT_EQ ( aux-&gt;NumStates(), 2 );</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keyword">delete</span> aux;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="classucam_1_1hifst_1_1ManualReplaceFstByArc.html" title="Creates FST replacement or not depending on conditions including program options. ...">uh::ManualReplaceFstByArc&lt;fst::StdArc&gt;</a> x ( vcat, replacefstbyarc,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        replacefstbyarcexceptions, <span class="keyword">true</span>, 0);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    fst::StdArc::Label label1 = <a class="code" href="global__decls_8hpp.html#a1e35b9fb56aa4d892554e9245b22c39e">APBASETAG</a> + 1 * <a class="code" href="global__decls_8hpp.html#a71c6908830dd7f665616db7ccd9942f7">APCCTAG</a> + 1;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    fst::VectorFst&lt;fst::StdArc&gt; *aux = x ( a, label1 );</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    ASSERT_TRUE ( aux == NULL );</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    fst::StdArc::Label label2 = <a class="code" href="global__decls_8hpp.html#a1e35b9fb56aa4d892554e9245b22c39e">APBASETAG</a> + 2 * APCCTAG + 1;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    aux = x ( a, label2 );</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    ASSERT_TRUE ( aux != NULL );</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    EXPECT_EQ ( aux-&gt;NumStates(), 2 );</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keyword">delete</span> aux;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;}</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno"><a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#acd0e2a1717660fffbdf767b031bf4d98">  465</a></span>&#160;<a class="code" href="address_8gtest_8cpp.html#aa792ce4e48d480e9db2126fd4137eb77" title="Tests wildcard expansion with an integer. ">TEST</a> ( HifstTest2, optimize ) {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <a class="code" href="classucam_1_1hifst_1_1OptimizeMachine.html">uh::OptimizeMachine&lt;fst::StdArc&gt;</a> om;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="comment">//FSA</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  fst::VectorFst&lt;fst::StdArc&gt; a ;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  a.AddState();</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  a.AddState();</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  a.AddState();</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  a.AddState();</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  a.SetStart ( 0 );</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  a.SetFinal ( 1, fst::StdArc::Weight::One() );</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  a.SetFinal ( 3, fst::StdArc::Weight::One() );</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  a.AddArc ( 0, fst::StdArc ( 1 , 1 , 0, 1 ) );</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  a.AddArc ( 0, fst::StdArc ( 1 , 1 , 0, 2 ) );</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  a.AddArc ( 2, fst::StdArc ( 0 , 0 , 0, 3 ) );</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  fst::VectorFst&lt;fst::StdArc&gt; d (a);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  fst::RmEpsilon (&amp;d); <span class="comment">//If above numstatethreshold</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">//If under numstatethreshold</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  fst::VectorFst&lt;fst::StdArc&gt; e (a);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  fst::Determinize (fst::RmEpsilonFst&lt;fst::StdArc&gt; (e), &amp;e);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  fst::Minimize (&amp;e);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  fst::VectorFst&lt;fst::StdArc&gt; b (a);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  om (&amp;b, 3);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  EXPECT_EQ ( d.NumStates(), b.NumStates() );</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  b = a;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  om (&amp;b, 4);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  EXPECT_TRUE ( Equivalent (e, b) );</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">//Fst. Now we cannot use Equivalent easily.</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  fst::VectorFst&lt;fst::StdArc&gt; c;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  c.AddState();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  c.AddState();</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  c.AddState();</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  c.AddState();</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  c.SetStart ( 0 );</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  c.SetFinal ( 1, fst::StdArc::Weight::One() );</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  c.SetFinal ( 3, fst::StdArc::Weight::One() );</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  c.AddArc ( 0, fst::StdArc ( 1 , 2 , 0, 1 ) );</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  c.AddArc ( 0, fst::StdArc ( 1 , 2 , 0, 2 ) );</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  c.AddArc ( 2, fst::StdArc ( 0 , 0 , 0, 3 ) );</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <a class="code" href="classucam_1_1hifst_1_1OptimizeMachine.html">uh::OptimizeMachine&lt;fst::StdArc&gt;</a> om1 (<span class="keyword">true</span>);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  om1 (&amp;c, 4);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  EXPECT_EQ (c.NumStates(), 2);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;}</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor">#ifndef GMAINTEST</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00510"></a><span class="lineno"><a class="code" href="hifst_8task_8hifst_8gtest_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">  510</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="applylm_8main_8cpp.html#ac0f2228420376f4db7e1274f2b41667c">main</a> ( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv ) {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  ::testing::InitGoogleTest ( &amp;argc, argv );</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordflow">return</span> RUN_ALL_TESTS();</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_eb8c2c6c0b2d8322989ab36eca0d27a6.html">ucam-smt</a></li><li class="navelem"><a class="el" href="dir_a5648fe88103fecf788a5eab781d4af7.html">cpp</a></li><li class="navelem"><a class="el" href="dir_a7b3382883981dfe14920ee4fe79a25e.html">tests</a></li><li class="navelem"><a class="el" href="hifst_8task_8hifst_8gtest_8cpp.html">hifst.task.hifst.gtest.cpp</a></li>
    <li class="footer">Generated on Thu Aug 28 2014 20:06:32 for Cambridge SMT System by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
