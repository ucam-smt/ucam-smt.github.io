

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Examples &mdash; SGNMT 1.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
    <link rel="top" title="SGNMT 1.1 documentation" href="index.html"/>
        <link rel="next" title="Common issues" href="faq.html"/>
        <link rel="prev" title="Decoders" href="decoders.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SGNMT
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial: Basics (T2T)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_pytorch.html">Tutorial: fairseq (PyTorch)</a></li>
<li class="toctree-l1"><a class="reference internal" href="adding_components.html">Tutorial: Adding new components</a></li>
<li class="toctree-l1"><a class="reference internal" href="bea19_gec.html">Tutorial:  Grammatical error correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_blocks.html">Tutorial: Blocks/Thano (outdated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line.html">Command-line reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="predictors.html">Predictors</a></li>
<li class="toctree-l1"><a class="reference internal" href="decoders.html">Decoders</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#university-of-cambridge-submission-to-wmt18-tensor2tensor">University of Cambridge submission to WMT18 (Tensor2Tensor)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#joint-word-bpe-decoding-with-multisegbeam-blocks-theano">Joint Word/BPE decoding with multisegbeam (Blocks/Theano)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lattice-rescoring-with-three-nmt-systems-blocks-theano">Lattice rescoring with three NMT systems (Blocks/Theano)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#iterative-nmt-beam-search-blocks-theano">Iterative NMT beam search (Blocks/Theano)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mbr-based-nmt-with-a-3-ensemble-blocks-theano">MBR-based NMT with a 3-ensemble (Blocks/Theano)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mbr-based-nmt-with-separately-tuned-thetas-blocks-theano">MBR-based NMT with separately tuned Thetas (Blocks/Theano)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exhaustive-n-best-list-rescoring-with-nmt-blocks-theano">Exhaustive n-best list rescoring with NMT (Blocks/Theano)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nmt-with-length-model-and-neural-language-model-blocks-theano">NMT with length model and neural language model (Blocks/Theano)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Common issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="cam.sgnmt.html">All modules</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">SGNMT</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Examples</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/examples.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="examples">
<span id="examples-label"></span><h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<p>SGNMT supports many different options, and small changes in the decoder configuration sometimes lead
to very different results. This page contains a list of SGNMT configuration files which have been used
in our group. Details such as paths and vocabulary sizes are exemplary as we do not provide model files.
Some of the examples are not comparable to the SGNMT 1.0 and higher as they rely on Theano/Blocks
or NPLM backends that are not supported anymore.
However, we hope that this list is still useful as a blueprint for your own experiments.</p>
<div class="section" id="university-of-cambridge-submission-to-wmt18-tensor2tensor">
<h2>University of Cambridge submission to WMT18 (Tensor2Tensor)<a class="headerlink" href="#university-of-cambridge-submission-to-wmt18-tensor2tensor" title="Permalink to this headline">¶</a></h2>
<p>These are the ini-files for the final decoding passes. Please write to <a class="reference external" href="mailto:fs439&#37;&#52;&#48;cam&#46;ac&#46;uk">fs439<span>&#64;</span>cam<span>&#46;</span>ac<span>&#46;</span>uk</a> for
access to the trained models.</p>
<p>English-German:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">predictors</span><span class="p">:</span> <span class="n">t2t</span><span class="p">,</span><span class="n">t2t</span><span class="p">,</span><span class="n">ngramc</span><span class="p">,</span><span class="n">ngramc</span><span class="p">,</span><span class="n">ngramc</span><span class="p">,</span><span class="n">ngramc</span><span class="p">,</span><span class="n">wc</span>
<span class="n">predictor_weights</span><span class="p">:</span> <span class="mf">5.7</span><span class="p">,</span><span class="mf">4.3</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">1.5</span>
<span class="n">src_test</span><span class="p">:</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mifs_scratch</span><span class="o">/</span><span class="n">fs439</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">wmt18</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">indexed_bpe</span><span class="o">/</span><span class="n">test18ts</span><span class="o">.</span><span class="n">ende</span><span class="o">.</span><span class="n">bpe</span><span class="o">.</span><span class="n">en</span>
<span class="n">beam</span><span class="p">:</span> <span class="mi">8</span>
<span class="n">early_stopping</span><span class="p">:</span> <span class="n">false</span>

<span class="n">pred_src_vocab_size</span><span class="p">:</span> <span class="mi">35627</span>
<span class="n">pred_trg_vocab_size</span><span class="p">:</span> <span class="mi">35627</span>
<span class="n">indexing_scheme</span><span class="p">:</span> <span class="n">t2t</span>
<span class="n">t2t_problem</span><span class="p">:</span> <span class="n">translate_ende_wmt18</span>

<span class="c1"># Relative transformer model</span>
<span class="n">t2t_checkpoint_dir</span><span class="p">:</span> <span class="n">t2t_train</span><span class="o">/</span><span class="n">translate_ende_wmt18</span><span class="o">/</span><span class="n">transformer</span><span class="o">-</span><span class="n">transformer_relative_big_large_batch4</span><span class="o">/</span><span class="n">average</span><span class="o">.</span><span class="mi">1000</span><span class="n">k</span><span class="o">/</span>
<span class="n">t2t_model</span><span class="p">:</span> <span class="n">transformer</span>
<span class="n">t2t_hparams_set</span><span class="p">:</span> <span class="n">transformer_relative_big</span>

<span class="c1"># Transformer model</span>
<span class="n">t2t_checkpoint_dir2</span><span class="p">:</span> <span class="n">t2t_train</span><span class="o">/</span><span class="n">translate_ende_wmt18</span><span class="o">/</span><span class="n">transformer</span><span class="o">-</span><span class="n">transformer_big_large_batch4</span><span class="o">/</span><span class="n">average</span><span class="o">.</span><span class="mi">1000</span><span class="n">k</span>
<span class="n">t2t_model2</span><span class="p">:</span> <span class="n">transformer</span>
<span class="n">t2t_hparams_set2</span><span class="p">:</span> <span class="n">transformer_big</span>

<span class="c1"># slicenet ngram posteriors</span>
<span class="n">ngramc_path</span><span class="p">:</span> <span class="n">supplementary</span><span class="o">/</span><span class="n">ende2</span><span class="o">/</span><span class="n">ss</span><span class="o">.</span><span class="n">ngramc_test18ts</span><span class="o">/%</span><span class="n">d</span><span class="o">.</span><span class="n">txt</span>

<span class="c1"># rnn ngram posteriors</span>
<span class="n">ngramc_path2</span><span class="p">:</span> <span class="n">supplementary</span><span class="o">/</span><span class="n">ende2</span><span class="o">/</span><span class="n">rr</span><span class="o">.</span><span class="n">ngramc_test18ts</span><span class="o">/%</span><span class="n">d</span><span class="o">.</span><span class="n">txt</span>

<span class="c1"># r2l ngram posteriors</span>
<span class="n">ngramc_path3</span><span class="p">:</span> <span class="n">supplementary</span><span class="o">/</span><span class="n">ende2</span><span class="o">/</span><span class="n">ender</span><span class="o">.</span><span class="n">ngramc_test18ts</span><span class="o">/%</span><span class="n">d</span><span class="o">.</span><span class="n">txt</span>

<span class="c1"># SDL posteriors</span>
<span class="n">ngramc_path4</span><span class="p">:</span> <span class="n">supplementary</span><span class="o">/</span><span class="n">ende</span><span class="o">/</span><span class="n">sdl</span><span class="o">.</span><span class="n">ngramc_test18ts</span><span class="o">/%</span><span class="n">d</span><span class="o">.</span><span class="n">txt</span>

<span class="n">outputs</span><span class="p">:</span> <span class="n">nbest</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">ngram</span>
</pre></div>
</div>
<p>German-English:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">like</span> <span class="n">English</span><span class="o">-</span><span class="n">German</span> <span class="k">with</span> <span class="n">the</span> <span class="n">following</span> <span class="n">predictor</span> <span class="n">weights</span><span class="p">)</span>
<span class="n">predictor_weights</span><span class="p">:</span> <span class="mf">4.2</span><span class="p">,</span><span class="mf">3.8</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.125</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="o">-</span><span class="mf">1.2</span>
</pre></div>
</div>
<p>Chinese-English:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">verbosity</span><span class="p">:</span> <span class="n">debug</span>
<span class="n">predictors</span><span class="p">:</span> <span class="n">t2t</span><span class="p">,</span><span class="n">t2t</span><span class="p">,</span><span class="n">ngramc</span><span class="p">,</span><span class="n">ngramc</span><span class="p">,</span><span class="n">ngramc</span><span class="p">,</span><span class="n">ngramc</span><span class="p">,</span><span class="n">wc</span>
<span class="n">predictor_weights</span><span class="p">:</span> <span class="mf">6.5</span><span class="p">,</span><span class="mf">5.5</span><span class="p">,</span><span class="mf">0.375</span><span class="p">,</span><span class="mf">0.375</span><span class="p">,</span><span class="mf">0.375</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span>
<span class="n">src_test</span><span class="p">:</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mifs_scratch</span><span class="o">/</span><span class="n">fs439</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">wmt18</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">indexed_bpe</span><span class="o">/</span><span class="n">test18</span><span class="o">.</span><span class="n">enzh</span><span class="o">.</span><span class="n">bpe</span><span class="o">.</span><span class="n">zh</span>
<span class="n">beam</span><span class="p">:</span> <span class="mi">8</span>
<span class="n">early_stopping</span><span class="p">:</span> <span class="n">false</span>

<span class="n">pred_src_vocab_size</span><span class="p">:</span> <span class="mi">43738</span>
<span class="n">pred_trg_vocab_size</span><span class="p">:</span> <span class="mi">34306</span>
<span class="n">indexing_scheme</span><span class="p">:</span> <span class="n">t2t</span>
<span class="n">t2t_problem</span><span class="p">:</span> <span class="n">translate_zhen_wmt18</span>

<span class="c1"># Relative transformer model</span>
<span class="n">t2t_checkpoint_dir</span><span class="p">:</span> <span class="n">t2t_train</span><span class="o">/</span><span class="n">translate_zhen_wmt18</span><span class="o">/</span><span class="n">transformer</span><span class="o">-</span><span class="n">transformer_relative_big_large_batch4</span><span class="o">/</span><span class="n">average</span><span class="o">.</span><span class="mi">1000</span><span class="n">k</span><span class="o">/</span>
<span class="n">t2t_model</span><span class="p">:</span> <span class="n">transformer</span>
<span class="n">t2t_hparams_set</span><span class="p">:</span> <span class="n">transformer_relative_big</span>

<span class="c1"># Transformer model</span>
<span class="n">t2t_checkpoint_dir2</span><span class="p">:</span> <span class="n">t2t_train</span><span class="o">/</span><span class="n">translate_zhen_wmt18</span><span class="o">/</span><span class="n">transformer</span><span class="o">-</span><span class="n">transformer_big_large_batch4</span><span class="o">/</span><span class="n">average</span><span class="o">.</span><span class="mi">1000</span><span class="n">k</span>
<span class="n">t2t_model2</span><span class="p">:</span> <span class="n">transformer</span>
<span class="n">t2t_hparams_set2</span><span class="p">:</span> <span class="n">transformer_big</span>

<span class="c1"># slicenet ngram posteriors</span>
<span class="n">ngramc_path</span><span class="p">:</span> <span class="n">supplementary</span><span class="o">/</span><span class="n">zhen2</span><span class="o">/</span><span class="n">ss</span><span class="o">.</span><span class="n">ngramc_test18</span><span class="o">/%</span><span class="n">d</span><span class="o">.</span><span class="n">txt</span>

<span class="c1"># rnn ngram posteriors</span>
<span class="n">ngramc_path2</span><span class="p">:</span> <span class="n">supplementary</span><span class="o">/</span><span class="n">zhen2</span><span class="o">/</span><span class="n">rr</span><span class="o">.</span><span class="n">ngramc_test18</span><span class="o">/%</span><span class="n">d</span><span class="o">.</span><span class="n">txt</span>

<span class="c1"># r2l ngram posteriors</span>
<span class="n">ngramc_path3</span><span class="p">:</span> <span class="n">supplementary</span><span class="o">/</span><span class="n">zhen2</span><span class="o">/</span><span class="n">zhenr</span><span class="o">.</span><span class="n">ngramc_test18</span><span class="o">/%</span><span class="n">d</span><span class="o">.</span><span class="n">txt</span>

<span class="c1"># SDL posteriors</span>
<span class="n">ngramc_path4</span><span class="p">:</span> <span class="n">supplementary</span><span class="o">/</span><span class="n">zhen</span><span class="o">/</span><span class="n">sdl</span><span class="o">.</span><span class="n">ngramc_test18</span><span class="o">/%</span><span class="n">d</span><span class="o">.</span><span class="n">txt</span>

<span class="n">outputs</span><span class="p">:</span> <span class="n">nbest</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">ngram</span>
</pre></div>
</div>
</div>
<div class="section" id="joint-word-bpe-decoding-with-multisegbeam-blocks-theano">
<h2>Joint Word/BPE decoding with multisegbeam (Blocks/Theano)<a class="headerlink" href="#joint-word-bpe-decoding-with-multisegbeam-blocks-theano" title="Permalink to this headline">¶</a></h2>
<p>Ensemble of a word-to-word system (vocabulary size: 30003) and a bpe-to-bpe system using the <code class="docutils literal"><span class="pre">multisegbeam</span></code>
decoding strategy, tested on WAT (ja-en):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">predictors</span><span class="p">:</span> <span class="n">nmt</span><span class="p">,</span><span class="n">altsrc_nmt</span>
<span class="n">src_test</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">dev</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">ja</span>
<span class="n">altsrc_test</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">dev</span><span class="o">.</span><span class="n">bpe</span><span class="o">.</span><span class="n">ja</span>
<span class="n">decoder</span><span class="p">:</span> <span class="n">multisegbeam</span>
<span class="n">multiseg_tokenizations</span><span class="p">:</span> <span class="s1">&#39;30003:data/wmap.en,eow:data/wmap.bpe.en&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="lattice-rescoring-with-three-nmt-systems-blocks-theano">
<h2>Lattice rescoring with three NMT systems (Blocks/Theano)<a class="headerlink" href="#lattice-rescoring-with-three-nmt-systems-blocks-theano" title="Permalink to this headline">¶</a></h2>
<p>Rescoring an SMT lattice on ja-en WAT with an ensemble of three NMT systems (ja-en WAT):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">predictors</span><span class="p">:</span> <span class="n">fst</span><span class="p">,</span><span class="n">nmt</span><span class="p">,</span><span class="n">nmt</span><span class="p">,</span><span class="n">nmt</span>
<span class="n">predictor_weights</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span>
<span class="n">src_test</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">bpe</span><span class="o">.</span><span class="n">ja</span>
<span class="n">early_stopping</span><span class="p">:</span> <span class="n">false</span>
<span class="n">hypo_recombination</span><span class="p">:</span> <span class="n">true</span>

<span class="n">fst_path</span><span class="p">:</span> <span class="n">lats</span><span class="o">.</span><span class="n">bpe_test</span><span class="o">/%</span><span class="n">d</span><span class="o">.</span><span class="n">fst</span>
<span class="n">use_fst_weights</span><span class="p">:</span> <span class="n">true</span>

<span class="n">gnmt_beta</span><span class="p">:</span> <span class="mf">0.01</span>
<span class="n">nmt_config</span><span class="p">:</span> <span class="n">src_vocab_size</span><span class="o">=</span><span class="mi">32081</span><span class="p">,</span><span class="n">trg_vocab_size</span><span class="o">=</span><span class="mi">30123</span>
<span class="n">nmt_path2</span><span class="p">:</span> <span class="o">../</span><span class="n">jaen</span><span class="o">-</span><span class="n">wat</span><span class="o">-</span><span class="n">bpe2</span><span class="o">/</span><span class="n">train</span>
<span class="n">nmt_path3</span><span class="p">:</span> <span class="o">../</span><span class="n">jaen</span><span class="o">-</span><span class="n">wat</span><span class="o">-</span><span class="n">bpe3</span><span class="o">/</span><span class="n">train</span>
</pre></div>
</div>
</div>
<div class="section" id="iterative-nmt-beam-search-blocks-theano">
<h2>Iterative NMT beam search (Blocks/Theano)<a class="headerlink" href="#iterative-nmt-beam-search-blocks-theano" title="Permalink to this headline">¶</a></h2>
<p>Using the <code class="docutils literal"><span class="pre">bucket</span></code> decoding strategy for pure NMT decoding with
multiple beam search passes:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">src_test</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">test15</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">en</span>
<span class="n">decoder</span><span class="p">:</span> <span class="n">bucket</span>
<span class="n">bucket_selector</span><span class="p">:</span> <span class="nb">iter</span>
<span class="n">max_node_expansions</span><span class="p">:</span> <span class="mi">2000</span>
<span class="n">predictors</span><span class="p">:</span> <span class="n">nmt</span>
<span class="n">length_normalization</span><span class="p">:</span> <span class="n">true</span>
<span class="n">nmt_config</span><span class="p">:</span> <span class="n">src_vocab_size</span><span class="o">=</span><span class="mi">50003</span><span class="p">,</span><span class="n">trg_vocab_size</span><span class="o">=</span><span class="mi">50003</span>
</pre></div>
</div>
</div>
<div class="section" id="mbr-based-nmt-with-a-3-ensemble-blocks-theano">
<h2>MBR-based NMT with a 3-ensemble (Blocks/Theano)<a class="headerlink" href="#mbr-based-nmt-with-a-3-ensemble-blocks-theano" title="Permalink to this headline">¶</a></h2>
<p>Using MBR-style n-gram posteriors together with a ensemble of three NMT systems
on ja-en WAT:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">predictors</span><span class="p">:</span> <span class="n">nmt</span><span class="p">,</span><span class="n">ngramc</span><span class="p">,</span><span class="n">wc</span><span class="p">,</span><span class="n">nmt</span><span class="p">,</span><span class="n">nmt</span>
<span class="n">predictor_weights</span><span class="p">:</span> <span class="mf">0.53125</span><span class="p">,</span><span class="mf">0.46875</span><span class="p">,</span><span class="mf">0.46875</span><span class="p">,</span><span class="mf">0.53125</span><span class="p">,</span><span class="mf">0.53125</span>
<span class="n">src_test</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">bpe</span><span class="o">.</span><span class="n">ja</span>
<span class="n">allow_unk_in_output</span><span class="p">:</span> <span class="n">false</span>
<span class="n">early_stopping</span><span class="p">:</span> <span class="n">false</span>
<span class="n">hypo_recombination</span><span class="p">:</span> <span class="n">true</span>

<span class="n">ngramc_path</span><span class="p">:</span> <span class="n">lats</span><span class="o">.</span><span class="n">ngramc</span><span class="o">.</span><span class="n">smooth</span><span class="o">.</span><span class="n">bpe_test</span><span class="o">/%</span><span class="n">d</span><span class="o">.</span><span class="n">txt</span>

<span class="n">gnmt_beta</span><span class="p">:</span> <span class="mf">0.01</span>
<span class="n">nmt_config</span><span class="p">:</span> <span class="n">src_vocab_size</span><span class="o">=</span><span class="mi">32081</span><span class="p">,</span><span class="n">trg_vocab_size</span><span class="o">=</span><span class="mi">30123</span>
<span class="n">nmt_path2</span><span class="p">:</span> <span class="o">../</span><span class="n">jaen</span><span class="o">-</span><span class="n">wat</span><span class="o">-</span><span class="n">bpe2</span><span class="o">/</span><span class="n">train</span>
<span class="n">nmt_path3</span><span class="p">:</span> <span class="o">../</span><span class="n">jaen</span><span class="o">-</span><span class="n">wat</span><span class="o">-</span><span class="n">bpe3</span><span class="o">/</span><span class="n">train</span>
</pre></div>
</div>
</div>
<div class="section" id="mbr-based-nmt-with-separately-tuned-thetas-blocks-theano">
<h2>MBR-based NMT with separately tuned Thetas (Blocks/Theano)<a class="headerlink" href="#mbr-based-nmt-with-separately-tuned-thetas-blocks-theano" title="Permalink to this headline">¶</a></h2>
<p>Tuning the n-gram posterior weights for each n-gram order separately on
WMT15 en-de:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">predictors</span><span class="p">:</span> <span class="n">ngramc</span><span class="p">,</span><span class="n">ngramc</span><span class="p">,</span><span class="n">ngramc</span><span class="p">,</span><span class="n">ngramc</span><span class="p">,</span><span class="n">wc</span><span class="p">,</span><span class="n">nmt</span>
<span class="n">predictor_weights</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.603674</span><span class="p">,</span><span class="mf">0.0950858</span><span class="p">,</span><span class="mf">0.514882</span><span class="p">,</span><span class="mf">0.713726</span><span class="p">,</span><span class="mf">0.510412</span>
<span class="n">src_test</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">test15</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">en</span>
<span class="n">beam</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">hypo_recombination</span><span class="p">:</span> <span class="n">true</span>
<span class="n">allow_unk_in_output</span><span class="p">:</span> <span class="n">false</span>

<span class="n">ngramc_path</span><span class="p">:</span> <span class="n">lats</span><span class="o">.</span><span class="n">mapped</span><span class="o">.</span><span class="n">ngramc</span><span class="o">.</span><span class="n">smooth_test15</span><span class="o">/%</span><span class="n">d</span><span class="o">.</span><span class="n">txt</span>
<span class="n">ngramc_order</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">ngramc_order2</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">ngramc_order3</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">ngramc_order4</span><span class="p">:</span> <span class="mi">4</span>

<span class="n">gnmt_beta</span><span class="p">:</span> <span class="mf">0.2</span>
<span class="n">nmt_config</span><span class="p">:</span> <span class="n">src_vocab_size</span><span class="o">=</span><span class="mi">50003</span><span class="p">,</span><span class="n">trg_vocab_size</span><span class="o">=</span><span class="mi">50003</span>
</pre></div>
</div>
</div>
<div class="section" id="exhaustive-n-best-list-rescoring-with-nmt-blocks-theano">
<h2>Exhaustive n-best list rescoring with NMT (Blocks/Theano)<a class="headerlink" href="#exhaustive-n-best-list-rescoring-with-nmt-blocks-theano" title="Permalink to this headline">¶</a></h2>
<p>Rescoring a complete n-best list on WMT15 en-de. The n-best list and the NMT system use different
word IDs:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">src_test</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">test15</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">en</span>
<span class="n">decoder</span><span class="p">:</span> <span class="n">dfs</span>
<span class="n">early_stopping</span><span class="p">:</span> <span class="n">false</span>
<span class="n">predictors</span><span class="p">:</span> <span class="n">idxmap_forcedlst</span><span class="p">,</span><span class="n">nmt</span>
<span class="n">src_idxmap</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">idxmap</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">test15</span><span class="o">.</span><span class="n">en</span>
<span class="n">trg_idxmap</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">idxmap</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">test15</span><span class="o">.</span><span class="n">de</span>
<span class="n">use_nbest_weights</span><span class="p">:</span> <span class="n">false</span>
<span class="n">trg_test</span><span class="p">:</span> <span class="o">../</span><span class="n">ende</span><span class="o">-</span><span class="n">wmt15</span><span class="o">/</span><span class="n">results</span><span class="o">/</span><span class="n">hifst_test15</span><span class="o">.</span><span class="mi">1000</span><span class="n">best</span>
<span class="n">nmt_config</span><span class="p">:</span> <span class="n">src_vocab_size</span><span class="o">=</span><span class="mi">50003</span><span class="p">,</span><span class="n">trg_vocab_size</span><span class="o">=</span><span class="mi">50003</span>
</pre></div>
</div>
</div>
<div class="section" id="nmt-with-length-model-and-neural-language-model-blocks-theano">
<h2>NMT with length model and neural language model (Blocks/Theano)<a class="headerlink" href="#nmt-with-length-model-and-neural-language-model-blocks-theano" title="Permalink to this headline">¶</a></h2>
<p>Pairing NMT with a length model and a neural language model, and rescoring HiFST
translation lattices with the mix. The lattice and the LM use alternative word maps:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">src_test</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">test15</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">en</span>
<span class="n">predictors</span><span class="p">:</span> <span class="n">idxmap_fst</span><span class="p">,</span><span class="n">length</span><span class="p">,</span><span class="n">idxmap_nplm</span><span class="p">,</span><span class="n">nmt</span>
<span class="n">predictor_weights</span><span class="p">:</span> <span class="mf">8.144021</span><span class="p">,</span><span class="mf">0.579325</span><span class="p">,</span><span class="mf">1.192874</span><span class="p">,</span><span class="mf">4.347711</span>
<span class="n">src_idxmap</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">idxmap</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">test15</span><span class="o">.</span><span class="n">en</span>
<span class="n">trg_idxmap</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">idxmap</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">test15</span><span class="o">.</span><span class="n">de</span>
<span class="n">fst_path</span><span class="p">:</span> <span class="n">lats_test15</span><span class="o">/%</span><span class="n">d</span><span class="o">.</span><span class="n">fst</span>
<span class="n">nmt_config</span><span class="p">:</span> <span class="n">src_vocab_size</span><span class="o">=</span><span class="mi">50003</span><span class="p">,</span><span class="n">trg_vocab_size</span><span class="o">=</span><span class="mi">50003</span>
<span class="n">use_fst_weights</span><span class="p">:</span> <span class="n">true</span>
<span class="n">length_model_weights</span><span class="p">:</span> <span class="mf">0.252503399924538</span><span class="p">,</span><span class="mf">1.26556504208994</span><span class="p">,</span><span class="mf">0.0476145832475248</span><span class="p">,</span><span class="mf">0.507108282728234</span><span class="p">,</span><span class="mf">0.0706249583462012</span><span class="p">,</span><span class="mf">0.00156446527534046</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0114873442886072</span><span class="p">,</span><span class="mf">0.00724551243039656</span><span class="p">,</span><span class="o">-</span><span class="mf">0.108343582699869</span><span class="p">,</span><span class="o">-</span><span class="mf">0.225865854796484</span><span class="p">,</span><span class="mf">0.183585648431748</span><span class="p">,</span><span class="o">-</span><span class="mf">0.367378141618226</span>
<span class="n">src_test_raw</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">test15</span><span class="o">.</span><span class="n">en</span>
<span class="n">nplm_path</span><span class="p">:</span> <span class="n">nplm</span><span class="o">/</span><span class="n">news12</span><span class="o">-</span><span class="mf">14.</span><span class="n">de</span><span class="o">.</span><span class="n">nnlm</span><span class="o">.</span><span class="n">news12</span><span class="o">-</span><span class="mf">14.5</span><span class="n">gram</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">large_8</span><span class="o">.</span><span class="mf">50000.0</span><span class="o">.</span><span class="mf">10.24</span><span class="o">.</span><span class="mf">3186.10</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="faq.html" class="btn btn-neutral float-right" title="Common issues" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="decoders.html" class="btn btn-neutral" title="Decoders" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, University of Cambridge.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>