

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installation &mdash; SGNMT 0.3.2 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
    <link rel="top" title="SGNMT 0.3.2 documentation" href="index.html"/>
        <link rel="next" title="Tutorial" href="tutorial.html"/>
        <link rel="prev" title="SGNMT" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SGNMT
          

          
          </a>

          
            
            
              <div class="version">
                0.3.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installing-dependencies">Installing dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installing-openfst">Installing OpenFST</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-tensor2tensor">Installing Tensor2Tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-tensorflow-not-t2t">Installing TensorFlow (not T2T)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-blocks">Installing Blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-srilm">Installing SRILM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-nplm">Installing NPLM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-sgnmt">Setting up SGNMT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="adding_components.html">Tutorial: Adding new components</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line.html">Command-line reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="predictors.html">Predictors</a></li>
<li class="toctree-l1"><a class="reference internal" href="decoders.html">Decoders</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Common issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="cam.sgnmt.html">All modules</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">SGNMT</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Installation</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/setup.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installation">
<span id="setup-label"></span><h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>The latest SGNMT version is available on github:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git clone https://github.com/ucam-smt/sgnmt.git
</pre></div>
</div>
<div class="section" id="installing-dependencies">
<h2>Installing dependencies<a class="headerlink" href="#installing-dependencies" title="Permalink to this headline">¶</a></h2>
<p>SGNMT depends on the following libraries:</p>
<ul class="simple">
<li><a class="reference external" href="http://openfst.org/">OpenFST</a> for reading and writing FSTs (e.g. translation lattices) (&gt;=1.5.4)</li>
<li>Optional: <a class="reference external" href="https://github.com/tensorflow/tensor2tensor">Tensor2Tensor</a> for a wide range of different sequence models (&gt;=1.3.1)</li>
<li>Optional: <a class="reference external" href="https://github.com/ehasler/tensorflow">Eva Hasler&#8217;s TensorFlow fork</a> for an extended version of TensorFlow&#8217;s seq2seq tutorial (latest)</li>
<li>Optional: <a class="reference external" href="http://blocks.readthedocs.io/en/latest/">Blocks</a> for neural machine translation support based on Theano (&gt;=0.1)</li>
<li>Optional: <a class="reference external" href="https://github.com/desilinguist/swig-srilm">srilm-swig</a> for reading ARPA language model files</li>
<li>Optional: <a class="reference external" href="http://nlg.isi.edu/software/nplm/">NPLM</a> for using feed-forward neural language models (&gt;=0.3)</li>
</ul>
<div class="section" id="installing-openfst">
<h3>Installing OpenFST<a class="headerlink" href="#installing-openfst" title="Permalink to this headline">¶</a></h3>
<p>We recommend to install <a class="reference external" href="http://openfst.org/twiki/bin/view/FST/FstDownload">OpenFST &gt;=1.5.4</a>. Make
sure to enable the Python support when compiling OpenFST:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ ./configure --enable-far --enable-python
$ make
$ make install
</pre></div>
</div>
<p>If you wish to use SGNMT in combination with the hierachical phrase-pased SMT system <a class="reference external" href="http://ucam-smt.github.io/">HiFST</a>,
you can directly use the OpenFST installation under <em>externals/</em> in the HiFST installation directory. This will make
it possible to create translation lattices with tropicalsparsetuple arcs with SGNMT to keep predictor scores separated
(see <em>fst</em> output format).</p>
<p><em>Tested versions: OpenFST 1.5.4-1.6.3</em></p>
</div>
<div class="section" id="installing-tensor2tensor">
<h3>Installing Tensor2Tensor<a class="headerlink" href="#installing-tensor2tensor" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/tensorflow/tensor2tensor">Tensor2Tensor</a> is a TensorFlow-based library with support of various neural
sequence models. SGNMT can access models trained with tensor2tensor via the <em>t2t</em> predictor. Follow the
<a class="reference external" href="https://github.com/tensorflow/tensor2tensor#installation">tensor2tensor installation instructions</a> to install t2t and
TensorFlow, and call SGNMT from the same environment. Note that SGNMT supports the <code class="docutils literal"><span class="pre">--t2t_usr_dir</span></code> argument to extend the
registry of T2T to your custom directory.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Tensor2Tensor code base is still under constant change, and SGNMT might not be compatible with the latest version.
The latest tensor2tensor version which is supported by SGNMT is available in <a class="reference external" href="https://github.com/fstahlberg/tensor2tensor">this fork</a>.</p>
</div>
<p><em>Tested versions: Tensor2Tensor 1.3.1, TensorFlow 1.4</em></p>
</div>
<div class="section" id="installing-tensorflow-not-t2t">
<h3>Installing TensorFlow (not T2T)<a class="headerlink" href="#installing-tensorflow-not-t2t" title="Permalink to this headline">¶</a></h3>
<p>The TensorFlow-based <code class="docutils literal"><span class="pre">nmt</span></code> and <code class="docutils literal"><span class="pre">rnnlm</span></code> predictors are based on <a class="reference external" href="https://github.com/ehasler/tensorflow">Eva Hasler&#8217;s TensorFlow fork</a>
which extends the seq2seq tutorial to reproduce the Bahdanau-style architecture.</p>
<p><strong>Note</strong>: You don&#8217;t need this fork if you access TensorFlow only over the Tensor2Tensor library.</p>
<p><em>Tested versions: latest</em></p>
</div>
<div class="section" id="installing-blocks">
<h3>Installing Blocks<a class="headerlink" href="#installing-blocks" title="Permalink to this headline">¶</a></h3>
<p>Follow the <a class="reference external" href="http://blocks.readthedocs.io/en/latest/setup.html">instructions</a> in
the Blocks documentation to install the Blocks framework and all its dependencies.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>It might be necessary to install the HDF5 development files before installing Blocks, e.g. with:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span>$ sudo apt-get install libhdf5-dev
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Make sure that all dependencies of Blocks are updated. On systems where you don&#8217;t have root access,
use the pip options <code class="docutils literal"><span class="pre">--user</span></code> and <code class="docutils literal"><span class="pre">--force-reinstall</span></code> to install updated packages locally.</p>
<p class="last"><a class="reference external" href="https://www.continuum.io/">Anaconda</a> is another good option for
local installations as it already sets up all packages Theano and Blocks depend on correctly. You still need
to install Blocks with the <a class="reference external" href="http://blocks.readthedocs.io/en/latest/setup.html">pip command</a> using
Anaconda&#8217;s pip.</p>
</div>
<p>You&#8217;ll also need to add <code class="docutils literal"><span class="pre">on_unused_input='ignore'</span></code> to your Theano flags as discussed <a class="reference external" href="https://github.com/mila-udem/blocks-examples/issues/58">here</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ export THEANO_FLAGS=&quot;on_unused_input=&#39;ignore&#39;&quot;
</pre></div>
</div>
<p><em>Tested versions: Blocks 0.1-0.2, Theano 0.8-0.9</em></p>
</div>
<div class="section" id="installing-srilm">
<h3>Installing SRILM<a class="headerlink" href="#installing-srilm" title="Permalink to this headline">¶</a></h3>
<p>First, install the version 1.7.1 of the <a class="reference external" href="http://www.speech.sri.com/projects/srilm/">SRI language model toolkit</a> if
you don&#8217;t already have an installation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>According to the <a class="reference external" href="https://github.com/desilinguist/swig-srilm">documentation</a>, swig-srilm requires that SRILM
is compiled as position independent code using <code class="docutils literal"><span class="pre">MAKE_PIC=yes</span></code>:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span>$ make World MAKE_PIC=yes
</pre></div>
</div>
</div>
<p>Then, checkout the srilm-swig project:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git clone https://github.com/desilinguist/swig-srilm.git
</pre></div>
</div>
<p>Modify the Makefile as explained in the <a class="reference external" href="https://github.com/desilinguist/swig-srilm">installation instructions</a>. For Ubuntu, the head of the make file should look like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SRILM_LIBS</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">srilm</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">i686</span><span class="o">-</span><span class="n">m64</span>
<span class="n">SRILM_INC</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">srilm</span><span class="o">/</span><span class="n">include</span>
<span class="n">PYTHON_INC</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span>
</pre></div>
</div>
<p>Build the Python module:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ make python
</pre></div>
</div>
<p><em>Tested versions: srilm 1.7.1</em></p>
</div>
<div class="section" id="installing-nplm">
<h3>Installing NPLM<a class="headerlink" href="#installing-nplm" title="Permalink to this headline">¶</a></h3>
<p>Download NPLM from the <a class="reference external" href="http://nlg.isi.edu/software/nplm/">project homepage</a> and install it. You can also
use the <a class="reference external" href="https://github.com/ucam-smt/nplm">UCAM NPLM fork</a> from Gonzalo Iglesias for threadsafety and efficiency.
If you are using nplm 0.3 there might be a bug in the Python module that prevents the nplm predictor from reading model files.
Try to replace <em>nplm.py</em> in the <em>python/</em> directory of your NPLM installation with <a class="reference external" href="http:///ucam-smt.io/sgnmt/html/_static/nplm.py">this file</a>.</p>
<p><em>Tested versions: nplm 0.3</em></p>
</div>
</div>
<div class="section" id="setting-up-sgnmt">
<h2>Setting up SGNMT<a class="headerlink" href="#setting-up-sgnmt" title="Permalink to this headline">¶</a></h2>
<p>Update your environment variables to reflect the locations of OpenFST, SRILM, and NPLM. On Ubuntu, it might be necessary to
add <em>/usr/local/lib</em> to your <code class="docutils literal"><span class="pre">LD_LIBRARY_PATH</span></code> (default location for OpenFST):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ export LD_LIBRARY_PATH=/usr/local/lib/:/path/to/swig-srilm/:/path/to/nplm/src/python:$LD_LIBRARY_PATH
$ export PYTHONPATH=/path/to/swig-srilm/:/path/to/nplm/python/:$PYTHONPATH
</pre></div>
</div>
<p>If OpenFST was not installed globally, you need to add it to your environment variables:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ export LD_LIBRARY_PATH=/path/to/openfst/lib:$LD_LIBRARY_PATH
$ export PYTHONPATH=/path/to/openfst/lib/python2.7/site-packages:$PYTHONPATH
</pre></div>
</div>
<p>Clone the GIT repository and try to start <code class="docutils literal"><span class="pre">decode.py</span></code> and <code class="docutils literal"><span class="pre">train.py</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git clone https://github.com/ucam-smt/sgnmt.git
$ cd sgnmt
$ python train.py --help
$ python decode.py --help
</pre></div>
</div>
<p>If you see the help texts for both commands, you are ready for the <a class="reference internal" href="tutorial.html#tutorial-label"><span class="std std-ref">Tutorial</span></a>. Otherwise, there is probably
something wrong with your OpenFST installation.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial.html" class="btn btn-neutral float-right" title="Tutorial" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="SGNMT" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, University of Cambridge.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.3.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>