

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>cam.sgnmt.blocks package &mdash; SGNMT 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
    <link rel="top" title="SGNMT 0.1 documentation" href="index.html"/>
        <link rel="up" title="cam.sgnmt package" href="cam.sgnmt.html"/>
        <link rel="next" title="cam.sgnmt.blocks.machine_translation package" href="cam.sgnmt.blocks.machine_translation.html"/>
        <link rel="prev" title="cam.sgnmt package" href="cam.sgnmt.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SGNMT
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line.html">Command-line reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="cam.sgnmt.predictors.html">Predictors</a></li>
<li class="toctree-l1"><a class="reference internal" href="cam.sgnmt.decoding.html">Decoders</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="cam.sgnmt.html">All modules</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="cam.sgnmt.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">cam.sgnmt.blocks package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cam-sgnmt-blocks-decode-module">cam.sgnmt.blocks.decode module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cam-sgnmt-blocks-train-module">cam.sgnmt.blocks.train module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-cam.sgnmt.blocks.ui">cam.sgnmt.blocks.ui module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-cam.sgnmt.blocks.vanilla_decoder">cam.sgnmt.blocks.vanilla_decoder module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-cam.sgnmt.blocks">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cam.sgnmt.decoding.html">cam.sgnmt.decoding package</a></li>
<li class="toctree-l3"><a class="reference internal" href="cam.sgnmt.predictors.html">cam.sgnmt.predictors package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.html#module-cam.sgnmt.output">cam.sgnmt.output module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.html#module-cam.sgnmt.utils">cam.sgnmt.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.html#module-cam.sgnmt">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">SGNMT</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="cam.sgnmt.html">cam.sgnmt package</a> &raquo;</li>
      
    <li>cam.sgnmt.blocks package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/cam.sgnmt.blocks.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cam-sgnmt-blocks-package">
<h1>cam.sgnmt.blocks package<a class="headerlink" href="#cam-sgnmt-blocks-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="cam.sgnmt.blocks.machine_translation.html">cam.sgnmt.blocks.machine_translation package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.blocks.machine_translation.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.blocks.machine_translation.html#module-cam.sgnmt.blocks.machine_translation.checkpoint">cam.sgnmt.blocks.machine_translation.checkpoint module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.blocks.machine_translation.html#module-cam.sgnmt.blocks.machine_translation.configurations">cam.sgnmt.blocks.machine_translation.configurations module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.blocks.machine_translation.html#module-cam.sgnmt.blocks.machine_translation.model">cam.sgnmt.blocks.machine_translation.model module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.blocks.machine_translation.html#module-cam.sgnmt.blocks.machine_translation.org__init__">cam.sgnmt.blocks.machine_translation.org__init__ module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.blocks.machine_translation.html#cam-sgnmt-blocks-machine-translation-org-main-module">cam.sgnmt.blocks.machine_translation.org__main__ module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.blocks.machine_translation.html#module-cam.sgnmt.blocks.machine_translation.prepare_data">cam.sgnmt.blocks.machine_translation.prepare_data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.blocks.machine_translation.html#module-cam.sgnmt.blocks.machine_translation.sampling">cam.sgnmt.blocks.machine_translation.sampling module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.blocks.machine_translation.html#module-cam.sgnmt.blocks.machine_translation.stream">cam.sgnmt.blocks.machine_translation.stream module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cam.sgnmt.blocks.machine_translation.html#module-cam.sgnmt.blocks.machine_translation">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="cam-sgnmt-blocks-decode-module">
<h2>cam.sgnmt.blocks.decode module<a class="headerlink" href="#cam-sgnmt-blocks-decode-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="cam-sgnmt-blocks-train-module">
<h2>cam.sgnmt.blocks.train module<a class="headerlink" href="#cam-sgnmt-blocks-train-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-cam.sgnmt.blocks.ui">
<span id="cam-sgnmt-blocks-ui-module"></span><h2>cam.sgnmt.blocks.ui module<a class="headerlink" href="#module-cam.sgnmt.blocks.ui" title="Permalink to this headline">¶</a></h2>
<p>This module handles configuration and user interface when using
blocks. <code class="docutils literal"><span class="pre">yaml</span></code> and <code class="docutils literal"><span class="pre">ArgumentParser</span></code> are used for parsing config
files and command line arguments.</p>
<dl class="function">
<dt id="cam.sgnmt.blocks.ui.get_args">
<code class="descclassname">cam.sgnmt.blocks.ui.</code><code class="descname">get_args</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cam/sgnmt/blocks/ui.html#get_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cam.sgnmt.blocks.ui.get_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the arguments for the current SGNMT run from both command
line arguments and configuration files. This method contains all
available SGNMT options, i.e. configuration is not encapsulated e.g.
by predictors. Additionally, we add blocks NMT model options as
parameters to specify how the loaded NMT model was trained. These
are defined in <code class="docutils literal"><span class="pre">machine_translation.configurations</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">object. Arguments object like for <code class="docutils literal"><span class="pre">ArgumentParser</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cam.sgnmt.blocks.ui.get_nmt_config_help">
<code class="descclassname">cam.sgnmt.blocks.ui.</code><code class="descname">get_nmt_config_help</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cam/sgnmt/blocks/ui.html#get_nmt_config_help"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cam.sgnmt.blocks.ui.get_nmt_config_help" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a dictionary with help text for the NMT configuration</p>
</dd></dl>

<dl class="function">
<dt id="cam.sgnmt.blocks.ui.get_parser">
<code class="descclassname">cam.sgnmt.blocks.ui.</code><code class="descname">get_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cam/sgnmt/blocks/ui.html#get_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cam.sgnmt.blocks.ui.get_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the parser object which is used to build the configuration
argument <code class="docutils literal"><span class="pre">args</span></code>. This is a helper method for <code class="docutils literal"><span class="pre">get_args()</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ArgumentParser. The pre-filled parser object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cam.sgnmt.blocks.ui.get_train_parser">
<code class="descclassname">cam.sgnmt.blocks.ui.</code><code class="descname">get_train_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cam/sgnmt/blocks/ui.html#get_train_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cam.sgnmt.blocks.ui.get_train_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the parser object for NMT training configuration.</p>
</dd></dl>

<dl class="function">
<dt id="cam.sgnmt.blocks.ui.parse_args">
<code class="descclassname">cam.sgnmt.blocks.ui.</code><code class="descname">parse_args</code><span class="sig-paren">(</span><em>parser</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cam/sgnmt/blocks/ui.html#parse_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cam.sgnmt.blocks.ui.parse_args" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://codereview.stackexchange.com/questions/79008/parse-a-config-file">http://codereview.stackexchange.com/questions/79008/parse-a-config-file</a>-
and-add-to-command-line-arguments-using-argparse-in-python</p>
</dd></dl>

<dl class="function">
<dt id="cam.sgnmt.blocks.ui.str2bool">
<code class="descclassname">cam.sgnmt.blocks.ui.</code><code class="descname">str2bool</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cam/sgnmt/blocks/ui.html#str2bool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cam.sgnmt.blocks.ui.str2bool" title="Permalink to this definition">¶</a></dt>
<dd><p>For making the <code class="docutils literal"><span class="pre">ArgumentParser</span></code> understand boolean values</p>
</dd></dl>

<dl class="function">
<dt id="cam.sgnmt.blocks.ui.validate_args">
<code class="descclassname">cam.sgnmt.blocks.ui.</code><code class="descname">validate_args</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cam/sgnmt/blocks/ui.html#validate_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cam.sgnmt.blocks.ui.validate_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Some very rudimental sanity checks for configuration options.
This method directly prints help messages to the user. In case of fatal
errors, it terminates using <code class="docutils literal"><span class="pre">logging.fatal()</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>args</strong> (<em>object</em>) &#8211; Configuration as returned by <code class="docutils literal"><span class="pre">get_args</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-cam.sgnmt.blocks.vanilla_decoder">
<span id="cam-sgnmt-blocks-vanilla-decoder-module"></span><h2>cam.sgnmt.blocks.vanilla_decoder module<a class="headerlink" href="#module-cam.sgnmt.blocks.vanilla_decoder" title="Permalink to this headline">¶</a></h2>
<p>This module bypasses the normal predictor framework and decodes
directly with <code class="docutils literal"><span class="pre">blocks.search.BeamSearch</span></code>. This is the original beam
search implementation in the blocks library, and is much faster than
going through the NMT predictor as it parallelizes expanding the active
hypotheses on the GPU. However, its less flexible because you can only
do pure single NMT decoding.</p>
<dl class="class">
<dt id="cam.sgnmt.blocks.vanilla_decoder.BlocksVanillaDecoder">
<em class="property">class </em><code class="descclassname">cam.sgnmt.blocks.vanilla_decoder.</code><code class="descname">BlocksVanillaDecoder</code><span class="sig-paren">(</span><em>nmt_model_path</em>, <em>config</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cam/sgnmt/blocks/vanilla_decoder.html#BlocksVanillaDecoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cam.sgnmt.blocks.vanilla_decoder.BlocksVanillaDecoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cam.sgnmt.decoding.html#cam.sgnmt.decoding.core.Decoder" title="cam.sgnmt.decoding.core.Decoder"><code class="xref py py-class docutils literal"><span class="pre">cam.sgnmt.decoding.core.Decoder</span></code></a></p>
<p>Adaptor class for blocks.search.BeamSearch. We implement the
<code class="docutils literal"><span class="pre">Decoder</span></code> class but ignore functionality for predictors or
heuristics. Instead, we pass through decoding directly to the
blocks beam search module. This is fast, but breaks with the
predictor framework. It can only be used for pure single system
NMT decoding.</p>
<dl class="method">
<dt id="cam.sgnmt.blocks.vanilla_decoder.BlocksVanillaDecoder.decode">
<code class="descname">decode</code><span class="sig-paren">(</span><em>src_sentence</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cam/sgnmt/blocks/vanilla_decoder.html#BlocksVanillaDecoder.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cam.sgnmt.blocks.vanilla_decoder.BlocksVanillaDecoder.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Decodes a single source sentence with the original blocks
beam search decoder. Does not use predictors. Note that the
score breakdowns in returned hypotheses are only on the
sentence level, not on the word level. For finer grained NMT
scores you need to use the nmt predictor. <code class="docutils literal"><span class="pre">src_sentence</span></code> is a
list of source word ids representing the source sentence without
&lt;S&gt; or &lt;/S&gt; symbols. As blocks expects to see &lt;/S&gt;, this method
adds it automatically.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>src_sentence</strong> (<em>list</em>) &#8211; List of source word ids without &lt;S&gt; or
&lt;/S&gt; which make up the source sentence</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list. A list of <code class="docutils literal"><span class="pre">Hypothesis</span></code> instances ordered by their
score.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cam.sgnmt.blocks.vanilla_decoder.BlocksVanillaDecoder.set_up_decoder">
<code class="descname">set_up_decoder</code><span class="sig-paren">(</span><em>nmt_model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cam/sgnmt/blocks/vanilla_decoder.html#BlocksVanillaDecoder.set_up_decoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cam.sgnmt.blocks.vanilla_decoder.BlocksVanillaDecoder.set_up_decoder" title="Permalink to this definition">¶</a></dt>
<dd><p>This method uses the NMT configuration in <code class="docutils literal"><span class="pre">self.config</span></code> to
initialize the NMT model. This method basically corresponds to
<code class="docutils literal"><span class="pre">blocks.machine_translation.main</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nmt_model_path</strong> (<em>string</em>) &#8211; Path to the NMT model file (.npz)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-cam.sgnmt.blocks">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-cam.sgnmt.blocks" title="Permalink to this headline">¶</a></h2>
<p>This module contains all code which depends on the blocks framework.
The only exception of this rule is <code class="docutils literal"><span class="pre">cam.sgnmt.predictors.blocks_neural</span></code>
The main entry points are <code class="docutils literal"><span class="pre">decode</span></code> and <code class="docutils literal"><span class="pre">train</span></code>, both are scripts
which can be started directly via command line.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cam.sgnmt.blocks.machine_translation.html" class="btn btn-neutral float-right" title="cam.sgnmt.blocks.machine_translation package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cam.sgnmt.html" class="btn btn-neutral" title="cam.sgnmt package" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Felix Stahlberg, University of Cambridge.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>